(function() {
  var firebase = require('./app-node');
  var h,n=this;function p(a){return void 0!==a}function aa(){}function ba(a){a.Ub=function(){return a.Ze?a.Ze:a.Ze=new a}}
function ca(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function da(a){return"array"==ca(a)}function ea(a){var b=ca(a);return"array"==b||"object"==b&&"number"==typeof a.length}function q(a){return"string"==typeof a}function fa(a){return"number"==typeof a}function t(a){return"function"==ca(a)}function ga(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ha(a,b,c){return a.call.apply(a.bind,arguments)}
function ia(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function u(a,b,c){u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ha:ia;return u.apply(null,arguments)}
function ja(a,b){function c(){}c.prototype=b.prototype;a.Lg=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Fg=function(a,c,f){for(var g=Array(arguments.length-2),k=2;k<arguments.length;k++)g[k-2]=arguments[k];return b.prototype[c].apply(a,g)}};function ka(){this.Xa=-1};function la(){this.Xa=-1;this.Xa=64;this.N=[];this.Sd=[];this.If=[];this.xd=[];this.xd[0]=128;for(var a=1;a<this.Xa;++a)this.xd[a]=0;this.Md=this.Zb=0;this.reset()}ja(la,ka);la.prototype.reset=function(){this.N[0]=1732584193;this.N[1]=4023233417;this.N[2]=2562383102;this.N[3]=271733878;this.N[4]=3285377520;this.Md=this.Zb=0};
function ma(a,b,c){c||(c=0);var d=a.If;if(q(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.N[0];c=a.N[1];for(var g=a.N[2],k=a.N[3],m=a.N[4],l,e=0;80>e;e++)40>e?20>e?(f=k^c&(g^k),l=1518500249):(f=c^g^k,l=1859775393):60>e?(f=c&g|k&(c|g),l=2400959708):(f=c^g^k,l=3395469782),f=(b<<
5|b>>>27)+f+m+l+d[e]&4294967295,m=k,k=g,g=(c<<30|c>>>2)&4294967295,c=b,b=f;a.N[0]=a.N[0]+b&4294967295;a.N[1]=a.N[1]+c&4294967295;a.N[2]=a.N[2]+g&4294967295;a.N[3]=a.N[3]+k&4294967295;a.N[4]=a.N[4]+m&4294967295}
la.prototype.update=function(a,b){if(null!=a){p(b)||(b=a.length);for(var c=b-this.Xa,d=0,e=this.Sd,f=this.Zb;d<b;){if(0==f)for(;d<=c;)ma(this,a,d),d+=this.Xa;if(q(a))for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,f==this.Xa){ma(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,f==this.Xa){ma(this,e);f=0;break}}this.Zb=f;this.Md+=b}};function v(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function na(a,b){var c={},d;for(d in a)c[d]=b.call(void 0,a[d],d,a);return c}function oa(a,b){for(var c in a)if(!b.call(void 0,a[c],c,a))return!1;return!0}function pa(a){var b=0,c;for(c in a)b++;return b}function qa(a){for(var b in a)return b}function ra(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function sa(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function ta(a,b){for(var c in a)if(a[c]==b)return!0;return!1}
function ua(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return d}function va(a,b){var c=ua(a,b,void 0);return c&&a[c]}function wa(a){for(var b in a)return!1;return!0}function xa(a){var b={},c;for(c in a)b[c]=a[c];return b};function ya(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a);}function za(){this.Dd=void 0}
function Aa(a,b,c){switch(typeof b){case "string":Ba(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(da(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],Aa(a,a.Dd?a.Dd.call(b,String(f),e):e,c),e=",";c.push("]");break}c.push("{");d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],"function"!=typeof e&&(c.push(d),Ba(f,c),
c.push(":"),Aa(a,a.Dd?a.Dd.call(b,f,e):e,c),d=","));c.push("}");break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var Ca={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Da=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;
function Ba(a,b){b.push('"',a.replace(Da,function(a){if(a in Ca)return Ca[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return Ca[a]=e+b.toString(16)}),'"')};var w;a:{var Ea=n.navigator;if(Ea){var Fa=Ea.userAgent;if(Fa){w=Fa;break a}}w=""};function Ga(a){if(Error.captureStackTrace)Error.captureStackTrace(this,Ga);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}ja(Ga,Error);Ga.prototype.name="CustomError";var x=Array.prototype,Ha=x.indexOf?function(a,b,c){return x.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(q(a))return q(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ia=x.forEach?function(a,b,c){x.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=q(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Ja=x.filter?function(a,b,c){return x.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=q(a)?
a.split(""):a,k=0;k<d;k++)if(k in g){var m=g[k];b.call(c,m,k,a)&&(e[f++]=m)}return e},Ka=x.map?function(a,b,c){return x.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=q(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},La=x.reduce?function(a,b,c,d){for(var e=[],f=1,g=arguments.length;f<g;f++)e.push(arguments[f]);d&&(e[0]=u(b,d));return x.reduce.apply(a,e)}:function(a,b,c,d){var e=c;Ia(a,function(c,g){e=b.call(d,e,c,g,a)});return e},Ma=x.every?function(a,b,
c){return x.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=q(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};function Na(a,b){var c=Oa(a,b,void 0);return 0>c?null:q(a)?a.charAt(c):a[c]}function Oa(a,b,c){for(var d=a.length,e=q(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function Pa(a,b){var c=Ha(a,b);0<=c&&x.splice.call(a,c,1)}function Qa(a,b){a.sort(b||Ra)}function Ra(a,b){return a>b?1:a<b?-1:0};var Sa=-1!=w.indexOf("Opera")||-1!=w.indexOf("OPR"),Ta=-1!=w.indexOf("Trident")||-1!=w.indexOf("MSIE"),Ua=-1!=w.indexOf("Gecko")&&-1==w.toLowerCase().indexOf("webkit")&&!(-1!=w.indexOf("Trident")||-1!=w.indexOf("MSIE")),Va=-1!=w.toLowerCase().indexOf("webkit");
(function(){var a="",b;if(Sa&&n.opera)return a=n.opera.version,t(a)?a():a;Ua?b=/rv\:([^\);]+)(\)|;)/:Ta?b=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Va&&(b=/WebKit\/(\S+)/);b&&(a=(a=b.exec(w))?a[1]:"");return Ta&&(b=(b=n.document)?b.documentMode:void 0,b>parseFloat(a))?String(b):a})();var Wa=null,Xa=null;
function Ya(a,b){if(!ea(a))throw Error("encodeByteArray takes an array as a parameter");if(!Wa){Wa={};Xa={};for(var c=0;65>c;c++)Wa[c]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c),Xa[c]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(c)}for(var c=b?Xa:Wa,d=[],e=0;e<a.length;e+=3){var f=a[e],g=e+1<a.length,k=g?a[e+1]:0,m=e+2<a.length,l=m?a[e+2]:0,r=f>>2,f=(f&3)<<4|k>>4,k=(k&15)<<2|l>>6,l=l&63;m||(l=64,g||(k=64));d.push(c[r],c[f],c[k],c[l])}return d.join("")}
;function Za(a){n.setTimeout(function(){throw a;},0)}var $a;
function ab(){var a=n.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&-1==w.indexOf("Presto")&&(a=function(){var a=document.createElement("iframe");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=u(function(a){if(("*"==d||a.origin==
d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&-1==w.indexOf("Trident")&&-1==w.indexOf("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(p(c.next)){c=c.next;var a=c.Je;c.Je=null;a()}};return function(a){d.next={Je:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("script")?function(a){var b=
document.createElement("script");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){n.setTimeout(a,0)}};function bb(a,b){cb||db();eb||(cb(),eb=!0);fb.push(new gb(a,b))}var cb;function db(){if(n.Promise&&n.Promise.resolve){var a=n.Promise.resolve();cb=function(){a.then(hb)}}else cb=function(){var a=hb;!t(n.setImmediate)||n.Window&&n.Window.prototype&&n.Window.prototype.setImmediate==n.setImmediate?($a||($a=ab()),$a(a)):n.setImmediate(a)}}var eb=!1,fb=[];[].push(function(){eb=!1;fb=[]});
function hb(){for(;fb.length;){var a=fb;fb=[];for(var b=0;b<a.length;b++){var c=a[b];try{c.Wf.call(c.scope)}catch(d){Za(d)}}}eb=!1}function gb(a,b){this.Wf=a;this.scope=b};function ib(a,b){this.L=jb;this.sf=void 0;this.Ca=this.Ga=null;this.fd=this.Zd=!1;if(a==kb)lb(this,mb,b);else try{var c=this;a.call(b,function(a){lb(c,mb,a)},function(a){if(!(a instanceof nb))try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(b){}lb(c,ob,a)})}catch(d){lb(this,ob,d)}}var jb=0,mb=2,ob=3;function kb(){}ib.prototype.then=function(a,b,c){return pb(this,t(a)?a:null,t(b)?b:null,c)};ib.prototype.then=ib.prototype.then;ib.prototype.$goog_Thenable=!0;h=ib.prototype;
h.Ag=function(a,b){return pb(this,null,a,b)};h.cancel=function(a){this.L==jb&&bb(function(){var b=new nb(a);qb(this,b)},this)};function qb(a,b){if(a.L==jb)if(a.Ga){var c=a.Ga;if(c.Ca){for(var d=0,e=-1,f=0,g;g=c.Ca[f];f++)if(g=g.k)if(d++,g==a&&(e=f),0<=e&&1<d)break;0<=e&&(c.L==jb&&1==d?qb(c,b):(d=c.Ca.splice(e,1)[0],rb(c,d,ob,b)))}a.Ga=null}else lb(a,ob,b)}function sb(a,b){a.Ca&&a.Ca.length||a.L!=mb&&a.L!=ob||tb(a);a.Ca||(a.Ca=[]);a.Ca.push(b)}
function pb(a,b,c,d){var e={k:null,gf:null,jf:null};e.k=new ib(function(a,g){e.gf=b?function(c){try{var e=b.call(d,c);a(e)}catch(l){g(l)}}:a;e.jf=c?function(b){try{var e=c.call(d,b);!p(e)&&b instanceof nb?g(b):a(e)}catch(l){g(l)}}:g});e.k.Ga=a;sb(a,e);return e.k}h.Bf=function(a){this.L=jb;lb(this,mb,a)};h.Cf=function(a){this.L=jb;lb(this,ob,a)};
function lb(a,b,c){if(a.L==jb){if(a==c)b=ob,c=new TypeError("Promise cannot resolve to itself");else{var d;if(c)try{d=!!c.$goog_Thenable}catch(e){d=!1}else d=!1;if(d){a.L=1;c.then(a.Bf,a.Cf,a);return}if(ga(c))try{var f=c.then;if(t(f)){ub(a,c,f);return}}catch(g){b=ob,c=g}}a.sf=c;a.L=b;a.Ga=null;tb(a);b!=ob||c instanceof nb||vb(a,c)}}function ub(a,b,c){function d(b){f||(f=!0,a.Cf(b))}function e(b){f||(f=!0,a.Bf(b))}a.L=1;var f=!1;try{c.call(b,e,d)}catch(g){d(g)}}
function tb(a){a.Zd||(a.Zd=!0,bb(a.Uf,a))}h.Uf=function(){for(;this.Ca&&this.Ca.length;){var a=this.Ca;this.Ca=null;for(var b=0;b<a.length;b++)rb(this,a[b],this.L,this.sf)}this.Zd=!1};function rb(a,b,c,d){if(c==mb)b.gf(d);else{if(b.k)for(;a&&a.fd;a=a.Ga)a.fd=!1;b.jf(d)}}function vb(a,b){a.fd=!0;bb(function(){a.fd&&wb.call(null,b)})}var wb=Za;function nb(a){Ga.call(this,a)}ja(nb,Ga);nb.prototype.name="cancel";function xb(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function z(a,b){if(Object.prototype.hasOwnProperty.call(a,b))return a[b]}function yb(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(c,a[c])};function A(a,b,c,d){var e;d<b?e="at least "+b:d>c&&(e=0===c?"none":"no more than "+c);if(e)throw Error(a+" failed: Was called with "+d+(1===d?" argument.":" arguments.")+" Expects "+e+".");}function zb(a,b,c){var d="";switch(b){case 1:d=c?"first":"First";break;case 2:d=c?"second":"Second";break;case 3:d=c?"third":"Third";break;case 4:d=c?"fourth":"Fourth";break;default:throw Error("errorPrefix called with argumentNumber > 4.  Need to update it?");}return a=a+" failed: "+(d+" argument ")}
function B(a,b,c,d){if((!d||p(c))&&!t(c))throw Error(zb(a,b,d)+"must be a valid function.");}function Ab(a,b,c){if(p(c)&&(!ga(c)||null===c))throw Error(zb(a,b,!0)+"must be a valid context object.");};function Bb(a){var b=[];yb(a,function(a,d){da(d)?Ia(d,function(d){b.push(encodeURIComponent(a)+"="+encodeURIComponent(d))}):b.push(encodeURIComponent(a)+"="+encodeURIComponent(d))});return b.length?"&"+b.join("&"):""};var Cb=n.Promise||ib;ib.prototype["catch"]=ib.prototype.Ag;function Db(){var a=this;this.reject=this.resolve=null;this.sa=new Cb(function(b,c){a.resolve=b;a.reject=c})}function Eb(a,b){return function(c,d){c?a.reject(c):a.resolve(d);t(b)&&(Fb(a.sa),1===b.length?b(c):b(c,d))}}function Fb(a){a.then(void 0,aa)};function Gb(a,b){if(!a)throw Hb(b);}function Hb(a){return Error("Firebase Database ("+firebase.SDK_VERSION+") INTERNAL ASSERT FAILED: "+a)};function Ib(a){for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);55296<=e&&56319>=e&&(e-=55296,d++,Gb(d<a.length,"Surrogate pair missing trail surrogate."),e=65536+(e<<10)+(a.charCodeAt(d)-56320));128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(65536>e?b[c++]=e>>12|224:(b[c++]=e>>18|240,b[c++]=e>>12&63|128),b[c++]=e>>6&63|128),b[c++]=e&63|128)}return b}function Jb(a){for(var b=0,c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b++:2048>d?b+=2:55296<=d&&56319>=d?(b+=4,c++):b+=3}return b};function Kb(a){return"undefined"!==typeof JSON&&p(JSON.parse)?JSON.parse(a):ya(a)}function C(a){if("undefined"!==typeof JSON&&p(JSON.stringify))a=JSON.stringify(a);else{var b=[];Aa(new za,a,b);a=b.join("")}return a};function Lb(a,b){this.committed=a;this.snapshot=b};function Mb(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:"")};function Nb(a){this.re=a;this.zd=[];this.Pb=0;this.Ud=-1;this.Eb=null}function Ob(a,b,c){a.Ud=b;a.Eb=c;a.Ud<a.Pb&&(a.Eb(),a.Eb=null)}function Pb(a,b,c){for(a.zd[b]=c;a.zd[a.Pb];){var d=a.zd[a.Pb];delete a.zd[a.Pb];for(var e=0;e<d.length;++e)if(d[e]){var f=a;Qb(function(){f.re(d[e])})}if(a.Pb===a.Ud){a.Eb&&(clearTimeout(a.Eb),a.Eb(),a.Eb=null);break}a.Pb++}};function Rb(){this.nc={}}Rb.prototype.set=function(a,b){null==b?delete this.nc[a]:this.nc[a]=b};Rb.prototype.get=function(a){return xb(this.nc,a)?this.nc[a]:null};Rb.prototype.remove=function(a){delete this.nc[a]};Rb.prototype.$e=!0;function Sb(a){this.sc=a;this.Ad="firebase:"}h=Sb.prototype;h.set=function(a,b){null==b?this.sc.removeItem(this.Ad+a):this.sc.setItem(this.Ad+a,C(b))};h.get=function(a){a=this.sc.getItem(this.Ad+a);return null==a?null:Kb(a)};h.remove=function(a){this.sc.removeItem(this.Ad+a)};h.$e=!1;h.toString=function(){return this.sc.toString()};function Tb(a){try{if("undefined"!==typeof window&&"undefined"!==typeof window[a]){var b=window[a];b.setItem("firebase:sentinel","cache");b.removeItem("firebase:sentinel");return new Sb(b)}}catch(c){}return new Rb}var Ub=Tb("localStorage"),Vb=Tb("sessionStorage");function Wb(a,b,c){this.type=Xb;this.source=a;this.path=b;this.Ia=c}Wb.prototype.Kc=function(a){return this.path.e()?new Wb(this.source,D,this.Ia.R(a)):new Wb(this.source,E(this.path),this.Ia)};Wb.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" overwrite: "+this.Ia.toString()+")"};function Yb(a,b){this.type=Zb;this.source=a;this.path=b}Yb.prototype.Kc=function(){return this.path.e()?new Yb(this.source,D):new Yb(this.source,E(this.path))};Yb.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" listen_complete)"};function $b(a){this.Fe=a}$b.prototype.getToken=function(a){return this.Fe.INTERNAL.getToken(a).then(null,function(a){return a&&"auth/token-not-initialized"===a.code?(ac("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(a)})};function bc(a,b){a.Fe.INTERNAL.addAuthTokenListener(b)};function cc(){this.Hd=F}cc.prototype.j=function(a){return this.Hd.Q(a)};cc.prototype.toString=function(){return this.Hd.toString()};function dc(a,b,c,d,e){this.host=a.toLowerCase();this.domain=this.host.substr(this.host.indexOf(".")+1);this.Pc=b;this.ne=c;this.Dg=d;this.lf=e||"";this.ab=Ub.get("host:"+a)||this.host}function ec(a,b){b!==a.ab&&(a.ab=b,"s-"===a.ab.substr(0,2)&&Ub.set("host:"+a.host,a.ab))}
function fc(a,b,c){H("string"===typeof b,"typeof type must == string");H("object"===typeof c,"typeof params must == object");if("websocket"===b)b=(a.Pc?"wss://":"ws://")+a.ab+"/.ws?";else if("long_polling"===b)b=(a.Pc?"https://":"http://")+a.ab+"/.lp?";else throw Error("Unknown connection type: "+b);a.host!==a.ab&&(c.ns=a.ne);var d=[];v(c,function(a,b){d.push(b+"="+a)});return b+d.join("&")}
dc.prototype.toString=function(){var a=(this.Pc?"https://":"http://")+this.host;this.lf&&(a+="<"+this.lf+">");return a};function gc(){this.rc={}}function hc(a,b,c){p(c)||(c=1);xb(a.rc,b)||(a.rc[b]=0);a.rc[b]+=c}gc.prototype.get=function(){return xa(this.rc)};function ic(a){this.Mf=a;this.od=null}ic.prototype.get=function(){var a=this.Mf.get(),b=xa(a);if(this.od)for(var c in this.od)b[c]-=this.od[c];this.od=a;return b};function jc(){this.ub=[]}function kc(a,b){for(var c=null,d=0;d<b.length;d++){var e=b[d],f=e.Xb();null===c||f.$(c.Xb())||(a.ub.push(c),c=null);null===c&&(c=new lc(f));c.add(e)}c&&a.ub.push(c)}function mc(a,b,c){kc(a,c);nc(a,function(a){return a.$(b)})}function oc(a,b,c){kc(a,c);nc(a,function(a){return a.contains(b)||b.contains(a)})}
function nc(a,b){for(var c=!0,d=0;d<a.ub.length;d++){var e=a.ub[d];if(e)if(e=e.Xb(),b(e)){for(var e=a.ub[d],f=0;f<e.ed.length;f++){var g=e.ed[f];if(null!==g){e.ed[f]=null;var k=g.Sb();pc&&ac("event: "+g.toString());Qb(k)}}a.ub[d]=null}else c=!1}c&&(a.ub=[])}function lc(a){this.ra=a;this.ed=[]}lc.prototype.add=function(a){this.ed.push(a)};lc.prototype.Xb=function(){return this.ra};function qc(a,b,c,d){this.Yd=b;this.Jd=c;this.Bd=d;this.dd=a}qc.prototype.Xb=function(){var a=this.Jd.vb();return"value"===this.dd?a.path:a.getParent().path};qc.prototype.de=function(){return this.dd};qc.prototype.Sb=function(){return this.Yd.Sb(this)};qc.prototype.toString=function(){return this.Xb().toString()+":"+this.dd+":"+C(this.Jd.Re())};function rc(a,b,c){this.Yd=a;this.error=b;this.path=c}rc.prototype.Xb=function(){return this.path};rc.prototype.de=function(){return"cancel"};
rc.prototype.Sb=function(){return this.Yd.Sb(this)};rc.prototype.toString=function(){return this.path.toString()+":cancel"};function sc(){}sc.prototype.Ue=function(){return null};sc.prototype.ce=function(){return null};var tc=new sc;function uc(a,b,c){this.Ff=a;this.Ma=b;this.wd=c}uc.prototype.Ue=function(a){var b=this.Ma.O;if(vc(b,a))return b.j().R(a);b=null!=this.wd?new wc(this.wd,!0,!1):this.Ma.w();return this.Ff.oc(a,b)};uc.prototype.ce=function(a,b,c){var d=null!=this.wd?this.wd:xc(this.Ma);a=this.Ff.Td(d,b,1,c,a);return 0===a.length?null:a[0]};function I(a,b,c,d){this.type=a;this.La=b;this.Ya=c;this.oe=d;this.Bd=void 0}function yc(a){return new I(zc,a)}var zc="value";function wc(a,b,c){this.A=a;this.ea=b;this.Rb=c}function Ac(a){return a.ea}function Bc(a){return a.Rb}function Cc(a,b){return b.e()?a.ea&&!a.Rb:vc(a,J(b))}function vc(a,b){return a.ea&&!a.Rb||a.A.Fa(b)}wc.prototype.j=function(){return this.A};function Dc(a,b){return Ec(a.name,b.name)}function Fc(a,b){return Ec(a,b)};function K(a,b){this.name=a;this.S=b}function Gc(a,b){return new K(a,b)};function Hc(a,b){return a&&"object"===typeof a?(H(".sv"in a,"Unexpected leaf node or priority contents"),b[a[".sv"]]):a}function Ic(a,b){var c=new Jc;Kc(a,new L(""),function(a,e){Lc(c,a,Mc(e,b))});return c}function Mc(a,b){var c=a.C().H(),c=Hc(c,b),d;if(a.J()){var e=Hc(a.Ea(),b);return e!==a.Ea()||c!==a.C().H()?new Nc(e,M(c)):a}d=a;c!==a.C().H()&&(d=d.ga(new Nc(c)));a.P(N,function(a,c){var e=Mc(c,b);e!==c&&(d=d.U(a,e))});return d};(function(){var a=process.version;if("v0.10.22"===a||"v0.10.23"===a||"v0.10.24"===a){var b=function(a,b,c){this.chunk=a;this.encoding=b;this.callback=c},c=function(a,c,d,e,l){c.objectMode||!1===c.decodeStrings||"string"!==typeof d||(d=new Buffer(d,e));Buffer.isBuffer(d)&&(e="buffer");var r=c.objectMode?1:d.length;c.length+=r;var y=c.length<c.highWaterMark;y||(c.needDrain=!0);c.writing?c.buffer.push(new b(d,e,l)):(c.writelen=r,c.writecb=l,c.writing=!0,c.sync=!0,a._write(d,e,c.onwrite),c.sync=!1);return y},
d=function(a,b,c,d){var e=!0;if(!Buffer.isBuffer(c)&&"string"!==typeof c&&null!==c&&void 0!==c&&!b.objectMode){var r=new TypeError("Invalid non-string/buffer chunk");a.emit("error",r);process.nextTick(function(){d(r)});e=!1}return e},e=function(a,b){var c=Error("write after end");a.emit("error",c);process.nextTick(function(){b(c)})},a=require("_stream_writable");a.prototype.write=function(a,b,k){var m=this._writableState,l=!1;"function"===typeof b&&(k=b,b=null);Buffer.isBuffer(a)?b="buffer":b||(b=
m.defaultEncoding);"function"!==typeof k&&(k=function(){});m.ended?e(this,k):d(this,m,a,k)&&(l=c(this,m,a,b,k));return l};require("_stream_duplex").prototype.write=a.prototype.write}})();var Oc=function(){var a=1;return function(){return a++}}(),H=Gb,Pc=Hb;function Qc(a){try{return(new Buffer(a,"base64")).toString("utf8")}catch(b){ac("base64Decode failed: ",b)}return null}function Rc(a){var b=Ib(a);a=new la;a.update(b);var b=[],c=8*a.Md;56>a.Zb?a.update(a.xd,56-a.Zb):a.update(a.xd,a.Xa-(a.Zb-56));for(var d=a.Xa-1;56<=d;d--)a.Sd[d]=c&255,c/=256;ma(a,a.Sd);for(d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c]=a.N[d]>>e&255,++c;return Ya(b)}
function Sc(a){for(var b="",c=0;c<arguments.length;c++)b=ea(arguments[c])?b+Sc.apply(null,arguments[c]):"object"===typeof arguments[c]?b+C(arguments[c]):b+arguments[c],b+=" ";return b}var pc=null,Tc=!0;
function Uc(a,b){Gb(!b||!0===a||!1===a,"Can't turn on custom loggers persistently.");!0===a?("undefined"!==typeof console&&("function"===typeof console.log?pc=u(console.log,console):"object"===typeof console.log&&(pc=function(a){console.log(a)})),b&&Vb.set("logging_enabled",!0)):t(a)?pc=a:(pc=null,Vb.remove("logging_enabled"))}function ac(a){!0===Tc&&(Tc=!1,null===pc&&!0===Vb.get("logging_enabled")&&Uc(!0));if(pc){var b=Sc.apply(null,arguments);pc(b)}}
function Vc(a){return function(){ac(a,arguments)}}function Wc(a){if("undefined"!==typeof console){var b="FIREBASE INTERNAL ERROR: "+Sc.apply(null,arguments);"undefined"!==typeof console.error?console.error(b):console.log(b)}}function Xc(a){var b=Sc.apply(null,arguments);throw Error("FIREBASE FATAL ERROR: "+b);}function O(a){if("undefined"!==typeof console){var b="FIREBASE WARNING: "+Sc.apply(null,arguments);"undefined"!==typeof console.warn?console.warn(b):console.log(b)}}
function Yc(a){var b,c,d,e,f,g=a;f=c=a=b="";d=!0;e="https";if(q(g)){var k=g.indexOf("//");0<=k&&(e=g.substring(0,k-1),g=g.substring(k+2));k=g.indexOf("/");-1===k&&(k=g.length);b=g.substring(0,k);f="";g=g.substring(k).split("/");for(k=0;k<g.length;k++)if(0<g[k].length){var m=g[k];try{m=decodeURIComponent(m.replace(/\+/g," "))}catch(l){}f+="/"+m}g=b.split(".");3===g.length?(a=g[1],c=g[0].toLowerCase()):2===g.length&&(a=g[0]);k=b.indexOf(":");0<=k&&(d="https"===e||"wss"===e)}"firebase"===a&&Xc(b+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead");
c&&"undefined"!=c||Xc("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com");d||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&O("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");return{hc:new dc(b,d,c,"ws"===e||"wss"===e),path:new L(f)}}function Zc(a){return fa(a)&&(a!=a||a==Number.POSITIVE_INFINITY||a==Number.NEGATIVE_INFINITY)}function $c(a){a()}
function Ec(a,b){if(a===b)return 0;if("[MIN_NAME]"===a||"[MAX_NAME]"===b)return-1;if("[MIN_NAME]"===b||"[MAX_NAME]"===a)return 1;var c=ad(a),d=ad(b);return null!==c?null!==d?0==c-d?a.length-b.length:c-d:-1:null!==d?1:a<b?-1:1}function bd(a,b){if(b&&a in b)return b[a];throw Error("Missing required key ("+a+") in object: "+C(b));}
function cd(a){if("object"!==typeof a||null===a)return C(a);var b=[],c;for(c in a)b.push(c);b.sort();c="{";for(var d=0;d<b.length;d++)0!==d&&(c+=","),c+=C(b[d]),c+=":",c+=cd(a[b[d]]);return c+"}"}function dd(a,b){if(a.length<=b)return[a];for(var c=[],d=0;d<a.length;d+=b)d+b>a?c.push(a.substring(d,a.length)):c.push(a.substring(d,d+b));return c}function ed(a,b){if(da(a))for(var c=0;c<a.length;++c)b(c,a[c]);else v(a,b)}
function fd(a){H(!Zc(a),"Invalid JSON number");var b,c,d,e;0===a?(d=c=0,b=-Infinity===1/a?1:0):(b=0>a,a=Math.abs(a),a>=Math.pow(2,-1022)?(d=Math.min(Math.floor(Math.log(a)/Math.LN2),1023),c=d+1023,d=Math.round(a*Math.pow(2,52-d)-Math.pow(2,52))):(c=0,d=Math.round(a/Math.pow(2,-1074))));e=[];for(a=52;a;--a)e.push(d%2?1:0),d=Math.floor(d/2);for(a=11;a;--a)e.push(c%2?1:0),c=Math.floor(c/2);e.push(b?1:0);e.reverse();b=e.join("");c="";for(a=0;64>a;a+=8)d=parseInt(b.substr(a,8),2).toString(16),1===d.length&&
(d="0"+d),c+=d;return c.toLowerCase()}var gd=/^-?\d{1,10}$/;function ad(a){return gd.test(a)&&(a=Number(a),-2147483648<=a&&2147483647>=a)?a:null}function Qb(a){try{a()}catch(b){setTimeout(function(){O("Exception was thrown by user callback.",b.stack||"");throw b;},Math.floor(0))}}function hd(a,b,c){Object.defineProperty(a,b,{get:c})}function id(a,b){var c=setTimeout(a,b);"object"===typeof c&&c.unref&&c.unref();return c};function jd(a){var b={},c={},d={},e="";try{var f=a.split("."),b=Kb(Qc(f[0])||""),c=Kb(Qc(f[1])||""),e=f[2],d=c.d||{};delete c.d}catch(g){}return{Ig:b,Ke:c,data:d,xg:e}}function kd(a){a=jd(a);var b=a.Ke;return!!a.xg&&!!b&&"object"===typeof b&&b.hasOwnProperty("iat")}function ld(a){a=jd(a).Ke;return"object"===typeof a&&!0===z(a,"admin")};function md(a,b,c){this.f=Vc("p:rest:");this.M=a;this.Fb=b;this.Rd=c;this.aa={}}function nd(a,b){if(p(b))return"tag$"+b;H(od(a.n),"should have a tag if it's not a default query.");return a.path.toString()}h=md.prototype;
h.af=function(a,b,c,d){var e=a.path.toString();this.f("Listen called for "+e+" "+a.ka());var f=nd(a,c),g={};this.aa[f]=g;a=pd(a.n);var k=this;qd(this,e+".json",a,function(a,b){var r=b;404===a&&(a=r=null);null===a&&k.Fb(e,r,!1,c);z(k.aa,f)===g&&d(a?401==a?"permission_denied":"rest_error:"+a:"ok",null)})};h.Df=function(a,b){var c=nd(a,b);delete this.aa[c]};h.of=function(){};h.pe=function(){};h.ff=function(){};h.vd=function(){};h.put=function(){};h.bf=function(){};h.we=function(){};
function qd(a,b,c,d){c=c||{};c.format="export";a.Rd.getToken(!1).then(function(e){(e=e&&e.accessToken)&&(c.auth=e);var f=(a.M.Pc?"https://":"http://")+a.M.host+b+"?"+Bb(c);a.f("Sending REST request for "+f);var g=new XMLHttpRequest;g.onreadystatechange=function(){if(d&&4===g.readyState){a.f("REST Response for "+f+" received. status:",g.status,"response:",g.responseText);var b=null;if(200<=g.status&&300>g.status){try{b=Kb(g.responseText)}catch(c){O("Failed to parse JSON response for "+f+": "+g.responseText)}d(null,
b)}else 401!==g.status&&404!==g.status&&O("Got unsuccessful REST response for "+f+" Status: "+g.status),d(g.status);d=null}};g.open("GET",f,!0);g.send()})};function rd(a,b,c){this.type=sd;this.source=a;this.path=b;this.children=c}rd.prototype.Kc=function(a){if(this.path.e())return a=this.children.subtree(new L(a)),a.e()?null:a.value?new Wb(this.source,D,a.value):new rd(this.source,D,a);H(J(this.path)===a,"Can't get a merge for a child not on the path of the operation");return new rd(this.source,E(this.path),this.children)};rd.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"};function ud(a,b){this.yf={};this.Sc=new ic(a);this.wa=b;var c=1E4+2E4*Math.random();id(u(this.pf,this),Math.floor(c))}ud.prototype.pf=function(){var a=this.Sc.get(),b={},c=!1,d;for(d in a)0<a[d]&&xb(this.yf,d)&&(b[d]=a[d],c=!0);c&&this.wa.we(b);id(u(this.pf,this),Math.floor(6E5*Math.random()))};var vd={},wd={};function xd(a){a=a.toString();vd[a]||(vd[a]=new gc);return vd[a]}function yd(a,b){var c=a.toString();wd[c]||(wd[c]=b());return wd[c]};var zd=null,zd=require("faye-websocket").Client;function Ad(a,b,c,d){this.Vd=a;this.f=Vc(this.Vd);this.frames=this.xc=null;this.ob=this.pb=this.De=0;this.Wa=xd(b);a={v:"5"};c&&(a.s=c);d&&(a.ls=d);this.Wd=fc(b,"websocket",a)}var Bd;
Ad.prototype.open=function(a,b){this.ib=b;this.fg=a;this.f("Websocket connecting to "+this.Wd);this.uc=!1;Ub.set("previous_websocket_failure",!0);try{var c={headers:{"User-Agent":"Firebase/5/"+firebase.SDK_VERSION+"/"+process.platform+"/Node"}},d=process.env,e=0==this.Wd.indexOf("wss://")?d.HTTPS_PROXY||d.https_proxy:d.HTTP_PROXY||d.http_proxy;e&&(c.proxy={origin:e});this.Ka=new zd(this.Wd,[],c)}catch(f){this.f("Error instantiating WebSocket.");(c=f.message||f.data)&&this.f(c);this.eb();return}var g=
this;this.Ka.onopen=function(){g.f("Websocket connected.");g.uc=!0};this.Ka.onclose=function(){g.f("Websocket connection was disconnected.");g.Ka=null;g.eb()};this.Ka.onmessage=function(a){if(null!==g.Ka)if(a=a.data,g.ob+=a.length,hc(g.Wa,"bytes_received",a.length),Cd(g),null!==g.frames)Dd(g,a);else{a:{H(null===g.frames,"We already have a frame buffer");if(6>=a.length){var b=Number(a);if(!isNaN(b)){g.De=b;g.frames=[];a=null;break a}}g.De=1;g.frames=[]}null!==a&&Dd(g,a)}};this.Ka.onerror=function(a){g.f("WebSocket error.  Closing connection.");
(a=a.message||a.data)&&g.f(a);g.eb()}};Ad.prototype.start=function(){};Ad.isAvailable=function(){var a=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var b=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);b&&1<b.length&&4.4>parseFloat(b[1])&&(a=!0)}return!a&&null!==zd&&!Bd};Ad.responsesRequiredToBeHealthy=2;Ad.healthyTimeout=3E4;h=Ad.prototype;h.pd=function(){Ub.remove("previous_websocket_failure")};
function Dd(a,b){a.frames.push(b);if(a.frames.length==a.De){var c=a.frames.join("");a.frames=null;c=Kb(c);a.fg(c)}}h.send=function(a){Cd(this);a=C(a);this.pb+=a.length;hc(this.Wa,"bytes_sent",a.length);a=dd(a,16384);1<a.length&&Ed(this,String(a.length));for(var b=0;b<a.length;b++)Ed(this,a[b])};h.Qc=function(){this.zb=!0;this.xc&&(clearInterval(this.xc),this.xc=null);this.Ka&&(this.Ka.close(),this.Ka=null)};
h.eb=function(){this.zb||(this.f("WebSocket is closing itself"),this.Qc(),this.ib&&(this.ib(this.uc),this.ib=null))};h.close=function(){this.zb||(this.f("WebSocket is being closed"),this.Qc())};function Cd(a){clearInterval(a.xc);a.xc=setInterval(function(){a.Ka&&Ed(a,"0");Cd(a)},Math.floor(45E3))}function Ed(a,b){try{a.Ka.send(b)}catch(c){a.f("Exception thrown from WebSocket.send():",c.message||c.data,"Closing connection."),setTimeout(u(a.eb,a),0)}};function Fd(){this.gb={}}
function Gd(a,b){var c=b.type,d=b.Ya;H("child_added"==c||"child_changed"==c||"child_removed"==c,"Only child changes supported for tracking");H(".priority"!==d,"Only non-priority child changes can be tracked.");var e=z(a.gb,d);if(e){var f=e.type;if("child_added"==c&&"child_removed"==f)a.gb[d]=new I("child_changed",b.La,d,e.La);else if("child_removed"==c&&"child_added"==f)delete a.gb[d];else if("child_removed"==c&&"child_changed"==f)a.gb[d]=new I("child_removed",e.oe,d);else if("child_changed"==c&&
"child_added"==f)a.gb[d]=new I("child_added",b.La,d);else if("child_changed"==c&&"child_changed"==f)a.gb[d]=new I("child_changed",b.La,d,e.oe);else throw Pc("Illegal combination of changes: "+b+" occurred after "+e);}else a.gb[d]=b};function Hd(a){this.W=a;this.g=a.n.g}function Id(a,b,c,d){var e=[],f=[];Ia(b,function(b){"child_changed"===b.type&&a.g.kd(b.oe,b.La)&&f.push(new I("child_moved",b.La,b.Ya))});Jd(a,e,"child_removed",b,d,c);Jd(a,e,"child_added",b,d,c);Jd(a,e,"child_moved",f,d,c);Jd(a,e,"child_changed",b,d,c);Jd(a,e,zc,b,d,c);return e}function Jd(a,b,c,d,e,f){d=Ja(d,function(a){return a.type===c});Qa(d,u(a.Of,a));Ia(d,function(c){var d=Kd(a,c,f);Ia(e,function(e){e.rf(c.type)&&b.push(e.createEvent(d,a.W))})})}
function Kd(a,b,c){"value"!==b.type&&"child_removed"!==b.type&&(b.Bd=c.We(b.Ya,b.La,a.g));return b}Hd.prototype.Of=function(a,b){if(null==a.Ya||null==b.Ya)throw Pc("Should only compare child_ events.");return this.g.compare(new K(a.Ya,a.La),new K(b.Ya,b.La))};function Ld(a,b){this.Od=a;this.Lf=b}function Md(a){this.V=a}
Md.prototype.fb=function(a,b,c,d){var e=new Fd,f;if(b.type===Xb)b.source.be?c=Nd(this,a,b.path,b.Ia,c,d,e):(H(b.source.Te,"Unknown source."),f=b.source.Ce||Bc(a.w())&&!b.path.e(),c=Od(this,a,b.path,b.Ia,c,d,f,e));else if(b.type===sd)b.source.be?c=Pd(this,a,b.path,b.children,c,d,e):(H(b.source.Te,"Unknown source."),f=b.source.Ce||Bc(a.w()),c=Qd(this,a,b.path,b.children,c,d,f,e));else if(b.type===Rd)if(b.Gd)if(b=b.path,null!=c.jc(b))c=a;else{f=new uc(c,a,d);d=a.O.j();if(b.e()||".priority"===J(b))Ac(a.w())?
b=c.Ba(xc(a)):(b=a.w().j(),H(b instanceof P,"serverChildren would be complete if leaf node"),b=c.pc(b)),b=this.V.za(d,b,e);else{var g=J(b),k=c.oc(g,a.w());null==k&&vc(a.w(),g)&&(k=d.R(g));b=null!=k?this.V.F(d,g,k,E(b),f,e):a.O.j().Fa(g)?this.V.F(d,g,F,E(b),f,e):d;b.e()&&Ac(a.w())&&(d=c.Ba(xc(a)),d.J()&&(b=this.V.za(b,d,e)))}d=Ac(a.w())||null!=c.jc(D);c=Sd(a,b,d,this.V.Pa())}else c=Td(this,a,b.path,b.Nb,c,d,e);else if(b.type===Zb)d=b.path,b=a.w(),f=b.j(),g=b.ea||d.e(),c=Ud(this,new Vd(a.O,new wc(f,
g,b.Rb)),d,c,tc,e);else throw Pc("Unknown operation type: "+b.type);e=ra(e.gb);d=c;b=d.O;b.ea&&(f=b.j().J()||b.j().e(),g=Wd(a),(0<e.length||!a.O.ea||f&&!b.j().$(g)||!b.j().C().$(g.C()))&&e.push(yc(Wd(d))));return new Ld(c,e)};
function Ud(a,b,c,d,e,f){var g=b.O;if(null!=d.jc(c))return b;var k;if(c.e())H(Ac(b.w()),"If change path is empty, we must have complete server data"),Bc(b.w())?(e=xc(b),d=d.pc(e instanceof P?e:F)):d=d.Ba(xc(b)),f=a.V.za(b.O.j(),d,f);else{var m=J(c);if(".priority"==m)H(1==Xd(c),"Can't have a priority with additional path components"),f=g.j(),k=b.w().j(),d=d.Xc(c,f,k),f=null!=d?a.V.ga(f,d):g.j();else{var l=E(c);vc(g,m)?(k=b.w().j(),d=d.Xc(c,g.j(),k),d=null!=d?g.j().R(m).F(l,d):g.j().R(m)):d=d.oc(m,
b.w());f=null!=d?a.V.F(g.j(),m,d,l,e,f):g.j()}}return Sd(b,f,g.ea||c.e(),a.V.Pa())}function Od(a,b,c,d,e,f,g,k){var m=b.w();g=g?a.V:a.V.Tb();if(c.e())d=g.za(m.j(),d,null);else if(g.Pa()&&!m.Rb)d=m.j().F(c,d),d=g.za(m.j(),d,null);else{var l=J(c);if(!Cc(m,c)&&1<Xd(c))return b;var r=E(c);d=m.j().R(l).F(r,d);d=".priority"==l?g.ga(m.j(),d):g.F(m.j(),l,d,r,tc,null)}m=m.ea||c.e();b=new Vd(b.O,new wc(d,m,g.Pa()));return Ud(a,b,c,e,new uc(e,b,f),k)}
function Nd(a,b,c,d,e,f,g){var k=b.O;e=new uc(e,b,f);if(c.e())g=a.V.za(b.O.j(),d,g),a=Sd(b,g,!0,a.V.Pa());else if(f=J(c),".priority"===f)g=a.V.ga(b.O.j(),d),a=Sd(b,g,k.ea,k.Rb);else{c=E(c);var m=k.j().R(f);if(!c.e()){var l=e.Ue(f);d=null!=l?".priority"===Yd(c)&&l.Q(c.parent()).e()?l:l.F(c,d):F}m.$(d)?a=b:(g=a.V.F(k.j(),f,d,c,e,g),a=Sd(b,g,k.ea,a.V.Pa()))}return a}
function Pd(a,b,c,d,e,f,g){var k=b;Zd(d,function(d,l){var r=c.k(d);vc(b.O,J(r))&&(k=Nd(a,k,r,l,e,f,g))});Zd(d,function(d,l){var r=c.k(d);vc(b.O,J(r))||(k=Nd(a,k,r,l,e,f,g))});return k}function $d(a,b){Zd(b,function(b,d){a=a.F(b,d)});return a}
function Qd(a,b,c,d,e,f,g,k){if(b.w().j().e()&&!Ac(b.w()))return b;var m=b;c=c.e()?d:ae(Q,c,d);var l=b.w().j();c.children.ia(function(c,d){if(l.Fa(c)){var G=b.w().j().R(c),G=$d(G,d);m=Od(a,m,new L(c),G,e,f,g,k)}});c.children.ia(function(c,d){var G=!vc(b.w(),c)&&null==d.value;l.Fa(c)||G||(G=b.w().j().R(c),G=$d(G,d),m=Od(a,m,new L(c),G,e,f,g,k))});return m}
function Td(a,b,c,d,e,f,g){if(null!=e.jc(c))return b;var k=Bc(b.w()),m=b.w();if(null!=d.value){if(c.e()&&m.ea||Cc(m,c))return Od(a,b,c,m.j().Q(c),e,f,k,g);if(c.e()){var l=Q;m.j().P(be,function(a,b){l=l.set(new L(a),b)});return Qd(a,b,c,l,e,f,k,g)}return b}l=Q;Zd(d,function(a){var b=c.k(a);Cc(m,b)&&(l=l.set(a,m.j().Q(b)))});return Qd(a,b,c,l,e,f,k,g)};function ce(a){this.g=a}h=ce.prototype;h.F=function(a,b,c,d,e,f){H(a.wc(this.g),"A node must be indexed if only a child is updated");e=a.R(b);if(e.Q(d).$(c.Q(d))&&e.e()==c.e())return a;null!=f&&(c.e()?a.Fa(b)?Gd(f,new I("child_removed",e,b)):H(a.J(),"A child remove without an old child only makes sense on a leaf node"):e.e()?Gd(f,new I("child_added",c,b)):Gd(f,new I("child_changed",c,b,e)));return a.J()&&c.e()?a:a.U(b,c).mb(this.g)};
h.za=function(a,b,c){null!=c&&(a.J()||a.P(N,function(a,e){b.Fa(a)||Gd(c,new I("child_removed",e,a))}),b.J()||b.P(N,function(b,e){if(a.Fa(b)){var f=a.R(b);f.$(e)||Gd(c,new I("child_changed",e,b,f))}else Gd(c,new I("child_added",e,b))}));return b.mb(this.g)};h.ga=function(a,b){return a.e()?F:a.ga(b)};h.Pa=function(){return!1};h.Tb=function(){return this};function de(a){this.ee=new ce(a.g);this.g=a.g;var b;a.la?(b=ee(a),b=a.g.Cc(fe(a),b)):b=a.g.Fc();this.Rc=b;a.oa?(b=ge(a),a=a.g.Cc(he(a),b)):a=a.g.Dc();this.tc=a}h=de.prototype;h.matches=function(a){return 0>=this.g.compare(this.Rc,a)&&0>=this.g.compare(a,this.tc)};h.F=function(a,b,c,d,e,f){this.matches(new K(b,c))||(c=F);return this.ee.F(a,b,c,d,e,f)};
h.za=function(a,b,c){b.J()&&(b=F);var d=b.mb(this.g),d=d.ga(F),e=this;b.P(N,function(a,b){e.matches(new K(a,b))||(d=d.U(a,F))});return this.ee.za(a,d,c)};h.ga=function(a){return a};h.Pa=function(){return!0};h.Tb=function(){return this.ee};function ie(a){this.ta=new de(a);this.g=a.g;H(a.ya,"Only valid if limit has been set");this.pa=a.pa;this.Hb=!je(a)}h=ie.prototype;h.F=function(a,b,c,d,e,f){this.ta.matches(new K(b,c))||(c=F);return a.R(b).$(c)?a:a.Db()<this.pa?this.ta.Tb().F(a,b,c,d,e,f):ke(this,a,b,c,e,f)};
h.za=function(a,b,c){var d;if(b.J()||b.e())d=F.mb(this.g);else if(2*this.pa<b.Db()&&b.wc(this.g)){d=F.mb(this.g);b=this.Hb?b.Yb(this.ta.tc,this.g):b.Wb(this.ta.Rc,this.g);for(var e=0;0<b.Ra.length&&e<this.pa;){var f=R(b),g;if(g=this.Hb?0>=this.g.compare(this.ta.Rc,f):0>=this.g.compare(f,this.ta.tc))d=d.U(f.name,f.S),e++;else break}}else{d=b.mb(this.g);d=d.ga(F);var k,m,l;if(this.Hb){b=d.Xe(this.g);k=this.ta.tc;m=this.ta.Rc;var r=le(this.g);l=function(a,b){return r(b,a)}}else b=d.Vb(this.g),k=this.ta.Rc,
m=this.ta.tc,l=le(this.g);for(var e=0,y=!1;0<b.Ra.length;)f=R(b),!y&&0>=l(k,f)&&(y=!0),(g=y&&e<this.pa&&0>=l(f,m))?e++:d=d.U(f.name,F)}return this.ta.Tb().za(a,d,c)};h.ga=function(a){return a};h.Pa=function(){return!0};h.Tb=function(){return this.ta.Tb()};
function ke(a,b,c,d,e,f){var g;if(a.Hb){var k=le(a.g);g=function(a,b){return k(b,a)}}else g=le(a.g);H(b.Db()==a.pa,"");var m=new K(c,d),l=a.Hb?me(b,a.g):ne(b,a.g),r=a.ta.matches(m);if(b.Fa(c)){for(var y=b.R(c),l=e.ce(a.g,l,a.Hb);null!=l&&(l.name==c||b.Fa(l.name));)l=e.ce(a.g,l,a.Hb);e=null==l?1:g(l,m);if(r&&!d.e()&&0<=e)return null!=f&&Gd(f,new I("child_changed",d,c,y)),b.U(c,d);null!=f&&Gd(f,new I("child_removed",y,c));b=b.U(c,F);return null!=l&&a.ta.matches(l)?(null!=f&&Gd(f,new I("child_added",
l.S,l.name)),b.U(l.name,l.S)):b}return d.e()?b:r&&0<=g(l,m)?(null!=f&&(Gd(f,new I("child_removed",l.S,l.name)),Gd(f,new I("child_added",d,c))),b.U(c,d).U(l.name,F)):b};function Nc(a,b){this.B=a;H(p(this.B)&&null!==this.B,"LeafNode shouldn't be created with null/undefined value.");this.ba=b||F;oe(this.ba);this.Cb=null}var pe=["object","boolean","number","string"];h=Nc.prototype;h.J=function(){return!0};h.C=function(){return this.ba};h.ga=function(a){return new Nc(this.B,a)};h.R=function(a){return".priority"===a?this.ba:F};h.Q=function(a){return a.e()?this:".priority"===J(a)?this.ba:F};h.Fa=function(){return!1};h.We=function(){return null};
h.U=function(a,b){return".priority"===a?this.ga(b):b.e()&&".priority"!==a?this:F.U(a,b).ga(this.ba)};h.F=function(a,b){var c=J(a);if(null===c)return b;if(b.e()&&".priority"!==c)return this;H(".priority"!==c||1===Xd(a),".priority must be the last token in a path");return this.U(c,F.F(E(a),b))};h.e=function(){return!1};h.Db=function(){return 0};h.P=function(){return!1};h.H=function(a){return a&&!this.C().e()?{".value":this.Ea(),".priority":this.C().H()}:this.Ea()};
h.hash=function(){if(null===this.Cb){var a="";this.ba.e()||(a+="priority:"+qe(this.ba.H())+":");var b=typeof this.B,a=a+(b+":"),a="number"===b?a+fd(this.B):a+this.B;this.Cb=Rc(a)}return this.Cb};h.Ea=function(){return this.B};h.qc=function(a){if(a===F)return 1;if(a instanceof P)return-1;H(a.J(),"Unknown node type");var b=typeof a.B,c=typeof this.B,d=Ha(pe,b),e=Ha(pe,c);H(0<=d,"Unknown leaf type: "+b);H(0<=e,"Unknown leaf type: "+c);return d===e?"object"===c?0:this.B<a.B?-1:this.B===a.B?0:1:e-d};
h.mb=function(){return this};h.wc=function(){return!0};h.$=function(a){return a===this?!0:a.J()?this.B===a.B&&this.ba.$(a.ba):!1};h.toString=function(){return C(this.H(!0))};function re(){}var se={};function le(a){return u(a.compare,a)}re.prototype.kd=function(a,b){return 0!==this.compare(new K("[MIN_NAME]",a),new K("[MIN_NAME]",b))};re.prototype.Fc=function(){return te};function ue(a){H(!a.e()&&".priority"!==J(a),"Can't create PathIndex with empty path or .priority key");this.ac=a}ja(ue,re);h=ue.prototype;h.vc=function(a){return!a.Q(this.ac).e()};h.compare=function(a,b){var c=a.S.Q(this.ac),d=b.S.Q(this.ac),c=c.qc(d);return 0===c?Ec(a.name,b.name):c};
h.Cc=function(a,b){var c=M(a),c=F.F(this.ac,c);return new K(b,c)};h.Dc=function(){var a=F.F(this.ac,ve);return new K("[MAX_NAME]",a)};h.toString=function(){return this.ac.slice().join("/")};function we(){}ja(we,re);h=we.prototype;h.compare=function(a,b){var c=a.S.C(),d=b.S.C(),c=c.qc(d);return 0===c?Ec(a.name,b.name):c};h.vc=function(a){return!a.C().e()};h.kd=function(a,b){return!a.C().$(b.C())};h.Fc=function(){return te};h.Dc=function(){return new K("[MAX_NAME]",new Nc("[PRIORITY-POST]",ve))};
h.Cc=function(a,b){var c=M(a);return new K(b,new Nc("[PRIORITY-POST]",c))};h.toString=function(){return".priority"};var N=new we;function xe(){}ja(xe,re);h=xe.prototype;h.compare=function(a,b){return Ec(a.name,b.name)};h.vc=function(){throw Pc("KeyIndex.isDefinedOn not expected to be called.");};h.kd=function(){return!1};h.Fc=function(){return te};h.Dc=function(){return new K("[MAX_NAME]",F)};h.Cc=function(a){H(q(a),"KeyIndex indexValue must always be a string.");return new K(a,F)};h.toString=function(){return".key"};
var be=new xe;function ye(){}ja(ye,re);h=ye.prototype;h.compare=function(a,b){var c=a.S.qc(b.S);return 0===c?Ec(a.name,b.name):c};h.vc=function(){return!0};h.kd=function(a,b){return!a.$(b)};h.Fc=function(){return te};h.Dc=function(){return ze};h.Cc=function(a,b){var c=M(a);return new K(b,c)};h.toString=function(){return".value"};var Ae=new ye;function Be(){this.Qb=this.oa=this.Jb=this.la=this.ya=!1;this.pa=0;this.lc="";this.cc=null;this.yb="";this.$b=null;this.wb="";this.g=N}var Ce=new Be;function je(a){return""===a.lc?a.la:"l"===a.lc}function fe(a){H(a.la,"Only valid if start has been set");return a.cc}function ee(a){H(a.la,"Only valid if start has been set");return a.Jb?a.yb:"[MIN_NAME]"}function he(a){H(a.oa,"Only valid if end has been set");return a.$b}
function ge(a){H(a.oa,"Only valid if end has been set");return a.Qb?a.wb:"[MAX_NAME]"}function De(a){var b=new Be;b.ya=a.ya;b.pa=a.pa;b.la=a.la;b.cc=a.cc;b.Jb=a.Jb;b.yb=a.yb;b.oa=a.oa;b.$b=a.$b;b.Qb=a.Qb;b.wb=a.wb;b.g=a.g;return b}h=Be.prototype;h.ke=function(a){var b=De(this);b.ya=!0;b.pa=a;b.lc="l";return b};h.le=function(a){var b=De(this);b.ya=!0;b.pa=a;b.lc="r";return b};h.Kd=function(a,b){var c=De(this);c.la=!0;p(a)||(a=null);c.cc=a;null!=b?(c.Jb=!0,c.yb=b):(c.Jb=!1,c.yb="");return c};
h.cd=function(a,b){var c=De(this);c.oa=!0;p(a)||(a=null);c.$b=a;p(b)?(c.Qb=!0,c.wb=b):(c.Kg=!1,c.wb="");return c};function Ee(a,b){var c=De(a);c.g=b;return c}function Fe(a){var b={};a.la&&(b.sp=a.cc,a.Jb&&(b.sn=a.yb));a.oa&&(b.ep=a.$b,a.Qb&&(b.en=a.wb));if(a.ya){b.l=a.pa;var c=a.lc;""===c&&(c=je(a)?"l":"r");b.vf=c}a.g!==N&&(b.i=a.g.toString());return b}function S(a){return!(a.la||a.oa||a.ya)}function od(a){return S(a)&&a.g==N}
function pd(a){var b={};if(od(a))return b;var c;a.g===N?c="$priority":a.g===Ae?c="$value":a.g===be?c="$key":(H(a.g instanceof ue,"Unrecognized index type!"),c=a.g.toString());b.orderBy=C(c);a.la&&(b.startAt=C(a.cc),a.Jb&&(b.startAt+=","+C(a.yb)));a.oa&&(b.endAt=C(a.$b),a.Qb&&(b.endAt+=","+C(a.wb)));a.ya&&(je(a)?b.limitToFirst=a.pa:b.limitToLast=a.pa);return b}h.toString=function(){return C(Fe(this))};function Ge(a,b){this.ld=a;this.bc=b}Ge.prototype.get=function(a){var b=z(this.ld,a);if(!b)throw Error("No index defined for "+a);return b===se?null:b};function He(a,b,c){var d=na(a.ld,function(d,f){var g=z(a.bc,f);H(g,"Missing index implementation for "+f);if(d===se){if(g.vc(b.S)){for(var k=[],m=c.Vb(Gc),l=R(m);l;)l.name!=b.name&&k.push(l),l=R(m);k.push(b);return Ie(k,le(g))}return se}g=c.get(b.name);k=d;g&&(k=k.remove(new K(b.name,g)));return k.Qa(b,b.S)});return new Ge(d,a.bc)}
function Je(a,b,c){var d=na(a.ld,function(a){if(a===se)return a;var d=c.get(b.name);return d?a.remove(new K(b.name,d)):a});return new Ge(d,a.bc)}var Ke=new Ge({".priority":se},{".priority":N});function Le(){this.set={}}h=Le.prototype;h.add=function(a,b){this.set[a]=null!==b?b:!0};h.contains=function(a){return xb(this.set,a)};h.get=function(a){return this.contains(a)?this.set[a]:void 0};h.remove=function(a){delete this.set[a]};h.clear=function(){this.set={}};h.e=function(){return wa(this.set)};h.count=function(){return pa(this.set)};function Me(a,b){v(a.set,function(a,d){b(d,a)})}h.keys=function(){var a=[];v(this.set,function(b,c){a.push(c)});return a};function Ne(a,b,c,d){this.Vd=a;this.f=Vc(a);this.hc=b;this.ob=this.pb=0;this.Wa=xd(b);this.Af=c;this.uc=!1;this.Bb=d;this.Vc=function(a){return fc(b,"long_polling",a)}}var Oe,Pe;
Ne.prototype.open=function(a,b){this.Ne=0;this.ja=b;this.ef=new Nb(a);this.zb=!1;var c=this;this.rb=setTimeout(function(){c.f("Timed out trying to connect.");c.eb();c.rb=null},Math.floor(3E4));$c(function(){if(!c.zb){c.Va=new Qe(function(a,b,d,k,m){Re(c,arguments);if(c.Va)if(c.rb&&(clearTimeout(c.rb),c.rb=null),c.uc=!0,"start"==a)c.id=b,c.og=d;else if("close"===a)b?(c.Va.wf=!1,Ob(c.ef,b,function(){c.eb()})):c.eb();else throw Error("Unrecognized command received: "+a);},function(a,b){Re(c,arguments);
Pb(c.ef,a,b)},function(){c.eb()},c.Vc);var a={start:"t"};a.ser=Math.floor(1E8*Math.random());c.Va.Cg&&(a.cb=c.Va.Cg);a.v="5";c.Af&&(a.s=c.Af);c.Bb&&(a.ls=c.Bb);a=c.Vc(a);c.f("Connecting via long-poll to "+a);Se(c.Va,a,function(){})}})};Ne.prototype.start=function(){var a=this.Va,b=this.og;a.me=this.id;a.df=b;for(a.Qd=!0;Te(a););};
Ne.isAvailable=function(){return Oe||!Pe&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.Eg)&&!1};h=Ne.prototype;h.pd=function(){};h.Qc=function(){this.zb=!0;this.Va&&(this.Va.close(),this.Va=null);this.cf&&(document.body.removeChild(this.cf),this.cf=null);this.rb&&(clearTimeout(this.rb),this.rb=null)};
h.eb=function(){this.zb||(this.f("Longpoll is closing itself"),this.Qc(),this.ja&&(this.ja(this.uc),this.ja=null))};h.close=function(){this.zb||(this.f("Longpoll is being closed."),this.Qc())};h.send=function(a){a=C(a);this.pb+=a.length;hc(this.Wa,"bytes_sent",a.length);a=Ib(a);a=Ya(a,!0);a=dd(a,1840);for(var b=0;b<a.length;b++){var c=this.Va;c.Nc.push({ug:this.Ne,Bg:a.length,Pe:a[b]});c.Qd&&Te(c);this.Ne++}};function Re(a,b){var c=C(b).length;a.ob+=c;hc(a.Wa,"bytes_received",c)}
function Qe(a,b,c,d){this.Vc=d;this.ib=c;this.te=new Le;this.Nc=[];this.Xd=Math.floor(1E8*Math.random());this.wf=!0;this.Nf=a;this.gg=b}Qe.prototype.close=function(){this.Qd=!1;if(this.rd){this.rd.Gg.body.innerHTML="";var a=this;setTimeout(function(){null!==a.rd&&(document.body.removeChild(a.rd),a.rd=null)},Math.floor(0))}if(this.me){var b={disconn:"t"};b.id=this.me;b.pw=this.df;b=this.Vc(b);Ue(b)}if(b=this.ib)this.ib=null,b()};
function Te(a){if(a.Qd&&a.wf&&a.te.count()<(0<a.Nc.length?2:1)){a.Xd++;var b={};b.id=a.me;b.pw=a.df;b.ser=a.Xd;for(var b=a.Vc(b),c="",d=0;0<a.Nc.length;)if(1870>=a.Nc[0].Pe.length+30+c.length){var e=a.Nc.shift(),c=c+"&seg"+d+"="+e.ug+"&ts"+d+"="+e.Bg+"&d"+d+"="+e.Pe;d++}else break;Ve(a,b+c,a.Xd);return!0}return!1}function Ve(a,b,c){function d(){a.te.remove(c);Te(a)}a.te.add(c,1);var e=setTimeout(d,Math.floor(25E3));Se(a,b,function(){clearTimeout(e);d()})}function Se(a,b,c){We(a,b,c)}var Xe=null;
function Ue(a,b){Xe||(Xe=require("request"));Xe(a,function(c,d,e){if(c)throw"Rest request for "+a.url+" failed.";b&&b(e)})}function We(a,b,c){Ue({url:b,Hg:!0},function(b){Ye(a,b);c()})}function Ye(a,b){eval("var jsonpCB = function(pLPCommand, pRTLPCB) {"+b+"}");jsonpCB(a.Nf,a.gg)};function Ze(a){$e(this,a)}var af=[Ne,Ad];function $e(a,b){var c=Ad&&Ad.isAvailable(),d=c&&!(Ub.$e||!0===Ub.get("previous_websocket_failure"));b.Dg&&(c||O("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),d=!0);if(d)a.Tc=[Ad];else{var e=a.Tc=[];ed(af,function(a,b){b&&b.isAvailable()&&e.push(b)})}}function bf(a){if(0<a.Tc.length)return a.Tc[0];throw Error("No transports available");};function cf(a,b,c,d,e,f,g){this.id=a;this.f=Vc("c:"+this.id+":");this.re=c;this.Jc=d;this.ja=e;this.qe=f;this.M=b;this.yd=[];this.Le=0;this.zf=new Ze(b);this.L=0;this.Bb=g;this.f("Connection created");df(this)}
function df(a){var b=bf(a.zf);a.I=new b("c:"+a.id+":"+a.Le++,a.M,void 0,a.Bb);a.ve=b.responsesRequiredToBeHealthy||0;var c=ef(a,a.I),d=ff(a,a.I);a.Uc=a.I;a.Oc=a.I;a.D=null;a.Ab=!1;setTimeout(function(){a.I&&a.I.open(c,d)},Math.floor(0));b=b.healthyTimeout||0;0<b&&(a.jd=id(function(){a.jd=null;a.Ab||(a.I&&102400<a.I.ob?(a.f("Connection exceeded healthy timeout but has received "+a.I.ob+" bytes.  Marking connection healthy."),a.Ab=!0,a.I.pd()):a.I&&10240<a.I.pb?a.f("Connection exceeded healthy timeout but has sent "+
a.I.pb+" bytes.  Leaving connection alive."):(a.f("Closing unhealthy connection after timeout."),a.close()))},Math.floor(b)))}function ff(a,b){return function(c){b===a.I?(a.I=null,c||0!==a.L?1===a.L&&a.f("Realtime connection lost."):(a.f("Realtime connection failed."),"s-"===a.M.ab.substr(0,2)&&(Ub.remove("host:"+a.M.host),a.M.ab=a.M.host)),a.close()):b===a.D?(a.f("Secondary connection lost."),c=a.D,a.D=null,a.Uc!==c&&a.Oc!==c||a.close()):a.f("closing an old connection")}}
function ef(a,b){return function(c){if(2!=a.L)if(b===a.Oc){var d=bd("t",c);c=bd("d",c);if("c"==d){if(d=bd("t",c),"d"in c)if(c=c.d,"h"===d){var d=c.ts,e=c.v,f=c.h;a.xf=c.s;ec(a.M,f);0==a.L&&(a.I.start(),gf(a,a.I,d),"5"!==e&&O("Protocol version mismatch detected"),c=a.zf,(c=1<c.Tc.length?c.Tc[1]:null)&&hf(a,c))}else if("n"===d){a.f("recvd end transmission on primary");a.Oc=a.D;for(c=0;c<a.yd.length;++c)a.ud(a.yd[c]);a.yd=[];jf(a)}else"s"===d?(a.f("Connection shutdown command received. Shutting down..."),
a.qe&&(a.qe(c),a.qe=null),a.ja=null,a.close()):"r"===d?(a.f("Reset packet received.  New host: "+c),ec(a.M,c),1===a.L?a.close():(kf(a),df(a))):"e"===d?Wc("Server Error: "+c):"o"===d?(a.f("got pong on primary."),lf(a),mf(a)):Wc("Unknown control packet command: "+d)}else"d"==d&&a.ud(c)}else if(b===a.D)if(d=bd("t",c),c=bd("d",c),"c"==d)"t"in c&&(c=c.t,"a"===c?nf(a):"r"===c?(a.f("Got a reset on secondary, closing it"),a.D.close(),a.Uc!==a.D&&a.Oc!==a.D||a.close()):"o"===c&&(a.f("got pong on secondary."),
a.uf--,nf(a)));else if("d"==d)a.yd.push(c);else throw Error("Unknown protocol layer: "+d);else a.f("message on old connection")}}cf.prototype.va=function(a){of(this,{t:"d",d:a})};function jf(a){a.Uc===a.D&&a.Oc===a.D&&(a.f("cleaning up and promoting a connection: "+a.D.Vd),a.I=a.D,a.D=null)}
function nf(a){0>=a.uf?(a.f("Secondary connection is healthy."),a.Ab=!0,a.D.pd(),a.D.start(),a.f("sending client ack on secondary"),a.D.send({t:"c",d:{t:"a",d:{}}}),a.f("Ending transmission on primary"),a.I.send({t:"c",d:{t:"n",d:{}}}),a.Uc=a.D,jf(a)):(a.f("sending ping on secondary."),a.D.send({t:"c",d:{t:"p",d:{}}}))}cf.prototype.ud=function(a){lf(this);this.re(a)};function lf(a){a.Ab||(a.ve--,0>=a.ve&&(a.f("Primary connection is healthy."),a.Ab=!0,a.I.pd()))}
function hf(a,b){a.D=new b("c:"+a.id+":"+a.Le++,a.M,a.xf);a.uf=b.responsesRequiredToBeHealthy||0;a.D.open(ef(a,a.D),ff(a,a.D));id(function(){a.D&&(a.f("Timed out trying to upgrade."),a.D.close())},Math.floor(6E4))}function gf(a,b,c){a.f("Realtime connection established.");a.I=b;a.L=1;a.Jc&&(a.Jc(c,a.xf),a.Jc=null);0===a.ve?(a.f("Primary connection is healthy."),a.Ab=!0):id(function(){mf(a)},Math.floor(5E3))}
function mf(a){a.Ab||1!==a.L||(a.f("sending ping on primary."),of(a,{t:"c",d:{t:"p",d:{}}}))}function of(a,b){if(1!==a.L)throw"Connection is not connected";a.Uc.send(b)}cf.prototype.close=function(){2!==this.L&&(this.f("Closing realtime connection."),this.L=2,kf(this),this.ja&&(this.ja(),this.ja=null))};function kf(a){a.f("Shutting down all connections");a.I&&(a.I.close(),a.I=null);a.D&&(a.D.close(),a.D=null);a.jd&&(clearTimeout(a.jd),a.jd=null)};function L(a,b){if(1==arguments.length){this.o=a.split("/");for(var c=0,d=0;d<this.o.length;d++)0<this.o[d].length&&(this.o[c]=this.o[d],c++);this.o.length=c;this.Z=0}else this.o=a,this.Z=b}function T(a,b){var c=J(a);if(null===c)return b;if(c===J(b))return T(E(a),E(b));throw Error("INTERNAL ERROR: innerPath ("+b+") is not within outerPath ("+a+")");}
function pf(a,b){for(var c=a.slice(),d=b.slice(),e=0;e<c.length&&e<d.length;e++){var f=Ec(c[e],d[e]);if(0!==f)return f}return c.length===d.length?0:c.length<d.length?-1:1}function J(a){return a.Z>=a.o.length?null:a.o[a.Z]}function Xd(a){return a.o.length-a.Z}function E(a){var b=a.Z;b<a.o.length&&b++;return new L(a.o,b)}function Yd(a){return a.Z<a.o.length?a.o[a.o.length-1]:null}h=L.prototype;
h.toString=function(){for(var a="",b=this.Z;b<this.o.length;b++)""!==this.o[b]&&(a+="/"+this.o[b]);return a||"/"};h.slice=function(a){return this.o.slice(this.Z+(a||0))};h.parent=function(){if(this.Z>=this.o.length)return null;for(var a=[],b=this.Z;b<this.o.length-1;b++)a.push(this.o[b]);return new L(a,0)};
h.k=function(a){for(var b=[],c=this.Z;c<this.o.length;c++)b.push(this.o[c]);if(a instanceof L)for(c=a.Z;c<a.o.length;c++)b.push(a.o[c]);else for(a=a.split("/"),c=0;c<a.length;c++)0<a[c].length&&b.push(a[c]);return new L(b,0)};h.e=function(){return this.Z>=this.o.length};h.$=function(a){if(Xd(this)!==Xd(a))return!1;for(var b=this.Z,c=a.Z;b<=this.o.length;b++,c++)if(this.o[b]!==a.o[c])return!1;return!0};
h.contains=function(a){var b=this.Z,c=a.Z;if(Xd(this)>Xd(a))return!1;for(;b<this.o.length;){if(this.o[b]!==a.o[c])return!1;++b;++c}return!0};var D=new L("");function qf(a,b){this.Sa=a.slice();this.Ja=Math.max(1,this.Sa.length);this.Qe=b;for(var c=0;c<this.Sa.length;c++)this.Ja+=Jb(this.Sa[c]);rf(this)}qf.prototype.push=function(a){0<this.Sa.length&&(this.Ja+=1);this.Sa.push(a);this.Ja+=Jb(a);rf(this)};qf.prototype.pop=function(){var a=this.Sa.pop();this.Ja-=Jb(a);0<this.Sa.length&&--this.Ja};
function rf(a){if(768<a.Ja)throw Error(a.Qe+"has a key path longer than 768 bytes ("+a.Ja+").");if(32<a.Sa.length)throw Error(a.Qe+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+sf(a));}function sf(a){return 0==a.Sa.length?"":"in property '"+a.Sa.join(".")+"'"};function tf(a){a instanceof uf||Xc("Don't call new Database() directly - please use firebase.database().");this.ua=a;this.ca=new U(a,D);this.INTERNAL=new vf(this)}var wf={TIMESTAMP:{".sv":"timestamp"}};h=tf.prototype;h.app=null;h.nf=function(a){xf(this,"ref");A("database.ref",0,1,arguments.length);return p(a)?this.ca.k(a):this.ca};
h.rg=function(a){xf(this,"database.refFromURL");A("database.refFromURL",1,1,arguments.length);var b=Yc(a);yf("database.refFromURL",b);var c=b.hc;c.host!==this.ua.M.host&&Xc("database.refFromURL: Host name does not match the current database: (found "+c.host+" but expected "+this.ua.M.host+")");return this.nf(b.path.toString())};function xf(a,b){null===a.ua&&Xc("Cannot call "+b+" on a deleted database.")}h.$f=function(){A("database.goOffline",0,0,arguments.length);xf(this,"goOffline");this.ua.bb()};
h.ag=function(){A("database.goOnline",0,0,arguments.length);xf(this,"goOnline");this.ua.ic()};Object.defineProperty(tf.prototype,"app",{get:function(){return this.ua.app}});function vf(a){this.Za=a}vf.prototype.delete=function(){xf(this.Za,"delete");var a=zf.Ub(),b=this.Za.ua;z(a.lb,b.app.name)!==b&&Xc("Database "+b.app.name+" has already been deleted.");b.bb();delete a.lb[b.app.name];this.Za.ua=null;this.Za.ca=null;this.Za=this.Za.INTERNAL=null;return firebase.Promise.resolve()};
tf.prototype.ref=tf.prototype.nf;tf.prototype.refFromURL=tf.prototype.rg;tf.prototype.goOnline=tf.prototype.ag;tf.prototype.goOffline=tf.prototype.$f;vf.prototype["delete"]=vf.prototype.delete;function Jc(){this.m=this.B=null}Jc.prototype.find=function(a){if(null!=this.B)return this.B.Q(a);if(a.e()||null==this.m)return null;var b=J(a);a=E(a);return this.m.contains(b)?this.m.get(b).find(a):null};function Lc(a,b,c){if(b.e())a.B=c,a.m=null;else if(null!==a.B)a.B=a.B.F(b,c);else{null==a.m&&(a.m=new Le);var d=J(b);a.m.contains(d)||a.m.add(d,new Jc);a=a.m.get(d);b=E(b);Lc(a,b,c)}}
function Af(a,b){if(b.e())return a.B=null,a.m=null,!0;if(null!==a.B){if(a.B.J())return!1;var c=a.B;a.B=null;c.P(N,function(b,c){Lc(a,new L(b),c)});return Af(a,b)}return null!==a.m?(c=J(b),b=E(b),a.m.contains(c)&&Af(a.m.get(c),b)&&a.m.remove(c),a.m.e()?(a.m=null,!0):!1):!0}function Kc(a,b,c){null!==a.B?c(b,a.B):a.P(function(a,e){var f=new L(b.toString()+"/"+a);Kc(e,f,c)})}Jc.prototype.P=function(a){null!==this.m&&Me(this.m,function(b,c){a(b,c)})};var Bf=/[\[\].#$\/\u0000-\u001F\u007F]/,Cf=/[\[\].#$\u0000-\u001F\u007F]/;function Df(a){return q(a)&&0!==a.length&&!Bf.test(a)}function Ef(a){return null===a||q(a)||fa(a)&&!Zc(a)||ga(a)&&xb(a,".sv")}function Ff(a,b,c,d){d&&!p(b)||Gf(zb(a,1,d),b,c)}
function Gf(a,b,c){c instanceof L&&(c=new qf(c,a));if(!p(b))throw Error(a+"contains undefined "+sf(c));if(t(b))throw Error(a+"contains a function "+sf(c)+" with contents: "+b.toString());if(Zc(b))throw Error(a+"contains "+b.toString()+" "+sf(c));if(q(b)&&b.length>10485760/3&&10485760<Jb(b))throw Error(a+"contains a string greater than 10485760 utf8 bytes "+sf(c)+" ('"+b.substring(0,50)+"...')");if(ga(b)){var d=!1,e=!1;yb(b,function(b,g){if(".value"===b)d=!0;else if(".priority"!==b&&".sv"!==b&&(e=
!0,!Df(b)))throw Error(a+" contains an invalid key ("+b+") "+sf(c)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');c.push(b);Gf(a,g,c);c.pop()});if(d&&e)throw Error(a+' contains ".value" child '+sf(c)+" in addition to actual children.");}}
function Hf(a,b){var c,d;for(c=0;c<b.length;c++){d=b[c];for(var e=d.slice(),f=0;f<e.length;f++)if((".priority"!==e[f]||f!==e.length-1)&&!Df(e[f]))throw Error(a+"contains an invalid key ("+e[f]+") in path "+d.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');}b.sort(pf);e=null;for(c=0;c<b.length;c++){d=b[c];if(null!==e&&e.contains(d))throw Error(a+"contains a path "+e.toString()+" that is ancestor of another path "+d.toString());e=d}}
function If(a,b,c){var d=zb(a,1,!1);if(!ga(b)||da(b))throw Error(d+" must be an object containing the children to replace.");var e=[];yb(b,function(a,b){var k=new L(a);Gf(d,b,c.k(k));if(".priority"===Yd(k)&&!Ef(b))throw Error(d+"contains an invalid value for '"+k.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");e.push(k)});Hf(d,e)}
function Jf(a,b,c){if(Zc(c))throw Error(zb(a,b,!1)+"is "+c.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ef(c))throw Error(zb(a,b,!1)+"must be a valid Firebase priority (a string, finite number, server value, or null).");}
function Kf(a,b,c){if(!c||p(b))switch(b){case "value":case "child_added":case "child_removed":case "child_changed":case "child_moved":break;default:throw Error(zb(a,1,c)+'must be a valid event type: "value", "child_added", "child_removed", "child_changed", or "child_moved".');}}function Lf(a,b){if(p(b)&&!Df(b))throw Error(zb(a,2,!0)+'was an invalid key: "'+b+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").');}
function Mf(a,b){if(!q(b)||0===b.length||Cf.test(b))throw Error(zb(a,1,!1)+'was an invalid path: "'+b+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"');}function Nf(a,b){if(".info"===J(b))throw Error(a+" failed: Can't modify data under /.info/");}
function yf(a,b){var c=b.path.toString(),d;!(d=!q(b.hc.host)||0===b.hc.host.length||!Df(b.hc.ne))&&(d=0!==c.length)&&(c&&(c=c.replace(/^\/*\.info(\/|$)/,"/")),d=!(q(c)&&0!==c.length&&!Cf.test(c)));if(d)throw Error(zb(a,1,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".');};function V(a,b){this.ua=a;this.ra=b}V.prototype.cancel=function(a){A("Firebase.onDisconnect().cancel",0,1,arguments.length);B("Firebase.onDisconnect().cancel",1,a,!0);var b=new Db;this.ua.vd(this.ra,Eb(b,a));return b.sa};V.prototype.cancel=V.prototype.cancel;V.prototype.remove=function(a){A("Firebase.onDisconnect().remove",0,1,arguments.length);Nf("Firebase.onDisconnect().remove",this.ra);B("Firebase.onDisconnect().remove",1,a,!0);var b=new Db;Of(this.ua,this.ra,null,Eb(b,a));return b.sa};
V.prototype.remove=V.prototype.remove;V.prototype.set=function(a,b){A("Firebase.onDisconnect().set",1,2,arguments.length);Nf("Firebase.onDisconnect().set",this.ra);Ff("Firebase.onDisconnect().set",a,this.ra,!1);B("Firebase.onDisconnect().set",2,b,!0);var c=new Db;Of(this.ua,this.ra,a,Eb(c,b));return c.sa};V.prototype.set=V.prototype.set;
V.prototype.Ib=function(a,b,c){A("Firebase.onDisconnect().setWithPriority",2,3,arguments.length);Nf("Firebase.onDisconnect().setWithPriority",this.ra);Ff("Firebase.onDisconnect().setWithPriority",a,this.ra,!1);Jf("Firebase.onDisconnect().setWithPriority",2,b);B("Firebase.onDisconnect().setWithPriority",3,c,!0);var d=new Db;Pf(this.ua,this.ra,a,b,Eb(d,c));return d.sa};V.prototype.setWithPriority=V.prototype.Ib;
V.prototype.update=function(a,b){A("Firebase.onDisconnect().update",1,2,arguments.length);Nf("Firebase.onDisconnect().update",this.ra);if(da(a)){for(var c={},d=0;d<a.length;++d)c[""+d]=a[d];a=c;O("Passing an Array to Firebase.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}If("Firebase.onDisconnect().update",a,this.ra);B("Firebase.onDisconnect().update",2,b,!0);
c=new Db;Qf(this.ua,this.ra,a,Eb(c,b));return c.sa};V.prototype.update=V.prototype.update;function Rf(a){H(da(a)&&0<a.length,"Requires a non-empty array");this.Jf=a;this.Bc={}}Rf.prototype.Ee=function(a,b){var c;c=this.Bc[a]||[];var d=c.length;if(0<d){for(var e=Array(d),f=0;f<d;f++)e[f]=c[f];c=e}else c=[];for(d=0;d<c.length;d++)c[d].Ie.apply(c[d].Oa,Array.prototype.slice.call(arguments,1))};Rf.prototype.ec=function(a,b,c){Sf(this,a);this.Bc[a]=this.Bc[a]||[];this.Bc[a].push({Ie:b,Oa:c});(a=this.Ve(a))&&b.apply(c,a)};
Rf.prototype.Gc=function(a,b,c){Sf(this,a);a=this.Bc[a]||[];for(var d=0;d<a.length;d++)if(a[d].Ie===b&&(!c||c===a[d].Oa)){a.splice(d,1);break}};function Sf(a,b){H(Na(a.Jf,function(a){return a===b}),"Unknown event: "+b)};function Tf(){Rf.call(this,["online"]);this.fc=!0;if("undefined"!==typeof window&&"undefined"!==typeof window.addEventListener&&!Mb()){var a=this;window.addEventListener("online",function(){a.fc||(a.fc=!0,a.Ee("online",!0))},!1);window.addEventListener("offline",function(){a.fc&&(a.fc=!1,a.Ee("online",!1))},!1)}}ja(Tf,Rf);Tf.prototype.Ve=function(a){H("online"===a,"Unknown event type: "+a);return[this.fc]};ba(Tf);function Uf(){Rf.call(this,["visible"]);var a,b;"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(b="visibilitychange",a="hidden"):"undefined"!==typeof document.mozHidden?(b="mozvisibilitychange",a="mozHidden"):"undefined"!==typeof document.msHidden?(b="msvisibilitychange",a="msHidden"):"undefined"!==typeof document.webkitHidden&&(b="webkitvisibilitychange",a="webkitHidden"));this.Lb=!0;if(b){var c=this;document.addEventListener(b,
function(){var b=!document[a];b!==c.Lb&&(c.Lb=b,c.Ee("visible",b))},!1)}}ja(Uf,Rf);Uf.prototype.Ve=function(a){H("visible"===a,"Unknown event type: "+a);return[this.Lb]};ba(Uf);var Vf=function(){var a=0,b=[];return function(c){var d=c===a;a=c;for(var e=Array(8),f=7;0<=f;f--)e[f]="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(c%64),c=Math.floor(c/64);H(0===c,"Cannot push at time == 0");c=e.join("");if(d){for(f=11;0<=f&&63===b[f];f--)b[f]=0;b[f]++}else for(f=0;12>f;f++)b[f]=Math.floor(64*Math.random());for(f=0;12>f;f++)c+="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(b[f]);H(20===c.length,"nextPushId: Length should be 20.");
return c}}();function Wf(a,b){this.Na=a;this.ca=b?b:Xf}h=Wf.prototype;h.Qa=function(a,b){return new Wf(this.Na,this.ca.Qa(a,b,this.Na).Y(null,null,!1,null,null))};h.remove=function(a){return new Wf(this.Na,this.ca.remove(a,this.Na).Y(null,null,!1,null,null))};h.get=function(a){for(var b,c=this.ca;!c.e();){b=this.Na(a,c.key);if(0===b)return c.value;0>b?c=c.left:0<b&&(c=c.right)}return null};
function Yf(a,b){for(var c,d=a.ca,e=null;!d.e();){c=a.Na(b,d.key);if(0===c){if(d.left.e())return e?e.key:null;for(d=d.left;!d.right.e();)d=d.right;return d.key}0>c?d=d.left:0<c&&(e=d,d=d.right)}throw Error("Attempted to find predecessor key for a nonexistent key.  What gives?");}h.e=function(){return this.ca.e()};h.count=function(){return this.ca.count()};h.Ec=function(){return this.ca.Ec()};h.dc=function(){return this.ca.dc()};h.ia=function(a){return this.ca.ia(a)};
h.Vb=function(a){return new Zf(this.ca,null,this.Na,!1,a)};h.Wb=function(a,b){return new Zf(this.ca,a,this.Na,!1,b)};h.Yb=function(a,b){return new Zf(this.ca,a,this.Na,!0,b)};h.Xe=function(a){return new Zf(this.ca,null,this.Na,!0,a)};function Zf(a,b,c,d,e){this.Fd=e||null;this.ie=d;this.Ra=[];for(e=1;!a.e();)if(e=b?c(a.key,b):1,d&&(e*=-1),0>e)a=this.ie?a.left:a.right;else if(0===e){this.Ra.push(a);break}else this.Ra.push(a),a=this.ie?a.right:a.left}
function R(a){if(0===a.Ra.length)return null;var b=a.Ra.pop(),c;c=a.Fd?a.Fd(b.key,b.value):{key:b.key,value:b.value};if(a.ie)for(b=b.left;!b.e();)a.Ra.push(b),b=b.right;else for(b=b.right;!b.e();)a.Ra.push(b),b=b.left;return c}function $f(a){if(0===a.Ra.length)return null;var b;b=a.Ra;b=b[b.length-1];return a.Fd?a.Fd(b.key,b.value):{key:b.key,value:b.value}}function ag(a,b,c,d,e){this.key=a;this.value=b;this.color=null!=c?c:!0;this.left=null!=d?d:Xf;this.right=null!=e?e:Xf}h=ag.prototype;
h.Y=function(a,b,c,d,e){return new ag(null!=a?a:this.key,null!=b?b:this.value,null!=c?c:this.color,null!=d?d:this.left,null!=e?e:this.right)};h.count=function(){return this.left.count()+1+this.right.count()};h.e=function(){return!1};h.ia=function(a){return this.left.ia(a)||a(this.key,this.value)||this.right.ia(a)};function bg(a){return a.left.e()?a:bg(a.left)}h.Ec=function(){return bg(this).key};h.dc=function(){return this.right.e()?this.key:this.right.dc()};
h.Qa=function(a,b,c){var d,e;e=this;d=c(a,e.key);e=0>d?e.Y(null,null,null,e.left.Qa(a,b,c),null):0===d?e.Y(null,b,null,null,null):e.Y(null,null,null,null,e.right.Qa(a,b,c));return cg(e)};function dg(a){if(a.left.e())return Xf;a.left.fa()||a.left.left.fa()||(a=eg(a));a=a.Y(null,null,null,dg(a.left),null);return cg(a)}
h.remove=function(a,b){var c,d;c=this;if(0>b(a,c.key))c.left.e()||c.left.fa()||c.left.left.fa()||(c=eg(c)),c=c.Y(null,null,null,c.left.remove(a,b),null);else{c.left.fa()&&(c=fg(c));c.right.e()||c.right.fa()||c.right.left.fa()||(c=gg(c),c.left.left.fa()&&(c=fg(c),c=gg(c)));if(0===b(a,c.key)){if(c.right.e())return Xf;d=bg(c.right);c=c.Y(d.key,d.value,null,null,dg(c.right))}c=c.Y(null,null,null,null,c.right.remove(a,b))}return cg(c)};h.fa=function(){return this.color};
function cg(a){a.right.fa()&&!a.left.fa()&&(a=hg(a));a.left.fa()&&a.left.left.fa()&&(a=fg(a));a.left.fa()&&a.right.fa()&&(a=gg(a));return a}function eg(a){a=gg(a);a.right.left.fa()&&(a=a.Y(null,null,null,null,fg(a.right)),a=hg(a),a=gg(a));return a}function hg(a){return a.right.Y(null,null,a.color,a.Y(null,null,!0,null,a.right.left),null)}function fg(a){return a.left.Y(null,null,a.color,null,a.Y(null,null,!0,a.left.right,null))}
function gg(a){return a.Y(null,null,!a.color,a.left.Y(null,null,!a.left.color,null,null),a.right.Y(null,null,!a.right.color,null,null))}function ig(){}h=ig.prototype;h.Y=function(){return this};h.Qa=function(a,b){return new ag(a,b,null)};h.remove=function(){return this};h.count=function(){return 0};h.e=function(){return!0};h.ia=function(){return!1};h.Ec=function(){return null};h.dc=function(){return null};h.fa=function(){return!1};var Xf=new ig;function P(a,b,c){this.m=a;(this.ba=b)&&oe(this.ba);a.e()&&H(!this.ba||this.ba.e(),"An empty node cannot have a priority");this.xb=c;this.Cb=null}h=P.prototype;h.J=function(){return!1};h.C=function(){return this.ba||F};h.ga=function(a){return this.m.e()?this:new P(this.m,a,this.xb)};h.R=function(a){if(".priority"===a)return this.C();a=this.m.get(a);return null===a?F:a};h.Q=function(a){var b=J(a);return null===b?this:this.R(b).Q(E(a))};h.Fa=function(a){return null!==this.m.get(a)};
h.U=function(a,b){H(b,"We should always be passing snapshot nodes");if(".priority"===a)return this.ga(b);var c=new K(a,b),d,e;b.e()?(d=this.m.remove(a),c=Je(this.xb,c,this.m)):(d=this.m.Qa(a,b),c=He(this.xb,c,this.m));e=d.e()?F:this.ba;return new P(d,e,c)};h.F=function(a,b){var c=J(a);if(null===c)return b;H(".priority"!==J(a)||1===Xd(a),".priority must be the last token in a path");var d=this.R(c).F(E(a),b);return this.U(c,d)};h.e=function(){return this.m.e()};h.Db=function(){return this.m.count()};
var jg=/^(0|[1-9]\d*)$/;h=P.prototype;h.H=function(a){if(this.e())return null;var b={},c=0,d=0,e=!0;this.P(N,function(f,g){b[f]=g.H(a);c++;e&&jg.test(f)?d=Math.max(d,Number(f)):e=!1});if(!a&&e&&d<2*c){var f=[],g;for(g in b)f[g]=b[g];return f}a&&!this.C().e()&&(b[".priority"]=this.C().H());return b};h.hash=function(){if(null===this.Cb){var a="";this.C().e()||(a+="priority:"+qe(this.C().H())+":");this.P(N,function(b,c){var d=c.hash();""!==d&&(a+=":"+b+":"+d)});this.Cb=""===a?"":Rc(a)}return this.Cb};
h.We=function(a,b,c){return(c=kg(this,c))?(a=Yf(c,new K(a,b)))?a.name:null:Yf(this.m,a)};function me(a,b){var c;c=(c=kg(a,b))?(c=c.Ec())&&c.name:a.m.Ec();return c?new K(c,a.m.get(c)):null}function ne(a,b){var c;c=(c=kg(a,b))?(c=c.dc())&&c.name:a.m.dc();return c?new K(c,a.m.get(c)):null}h.P=function(a,b){var c=kg(this,a);return c?c.ia(function(a){return b(a.name,a.S)}):this.m.ia(b)};h.Vb=function(a){return this.Wb(a.Fc(),a)};
h.Wb=function(a,b){var c=kg(this,b);if(c)return c.Wb(a,function(a){return a});for(var c=this.m.Wb(a.name,Gc),d=$f(c);null!=d&&0>b.compare(d,a);)R(c),d=$f(c);return c};h.Xe=function(a){return this.Yb(a.Dc(),a)};h.Yb=function(a,b){var c=kg(this,b);if(c)return c.Yb(a,function(a){return a});for(var c=this.m.Yb(a.name,Gc),d=$f(c);null!=d&&0<b.compare(d,a);)R(c),d=$f(c);return c};h.qc=function(a){return this.e()?a.e()?0:-1:a.J()||a.e()?1:a===ve?-1:0};
h.mb=function(a){if(a===be||ta(this.xb.bc,a.toString()))return this;var b=this.xb,c=this.m;H(a!==be,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var d=[],e=!1,c=c.Vb(Gc),f=R(c);f;)e=e||a.vc(f.S),d.push(f),f=R(c);d=e?Ie(d,le(a)):se;e=a.toString();c=xa(b.bc);c[e]=a;a=xa(b.ld);a[e]=d;return new P(this.m,this.ba,new Ge(a,c))};h.wc=function(a){return a===be||ta(this.xb.bc,a.toString())};
h.$=function(a){if(a===this)return!0;if(a.J())return!1;if(this.C().$(a.C())&&this.m.count()===a.m.count()){var b=this.Vb(N);a=a.Vb(N);for(var c=R(b),d=R(a);c&&d;){if(c.name!==d.name||!c.S.$(d.S))return!1;c=R(b);d=R(a)}return null===c&&null===d}return!1};function kg(a,b){return b===be?null:a.xb.get(b.toString())}h.toString=function(){return C(this.H(!0))};function M(a,b){if(null===a)return F;var c=null;"object"===typeof a&&".priority"in a?c=a[".priority"]:"undefined"!==typeof b&&(c=b);H(null===c||"string"===typeof c||"number"===typeof c||"object"===typeof c&&".sv"in c,"Invalid priority type found: "+typeof c);"object"===typeof a&&".value"in a&&null!==a[".value"]&&(a=a[".value"]);if("object"!==typeof a||".sv"in a)return new Nc(a,M(c));if(a instanceof Array){var d=F,e=a;v(e,function(a,b){if(xb(e,b)&&"."!==b.substring(0,1)){var c=M(a);if(c.J()||!c.e())d=
d.U(b,c)}});return d.ga(M(c))}var f=[],g=!1,k=a;yb(k,function(a){if("string"!==typeof a||"."!==a.substring(0,1)){var b=M(k[a]);b.e()||(g=g||!b.C().e(),f.push(new K(a,b)))}});if(0==f.length)return F;var m=Ie(f,Dc,function(a){return a.name},Fc);if(g){var l=Ie(f,le(N));return new P(m,M(c),new Ge({".priority":l},{".priority":N}))}return new P(m,M(c),Ke)}var lg=Math.log(2);
function mg(a){this.count=parseInt(Math.log(a+1)/lg,10);this.Oe=this.count-1;this.Kf=a+1&parseInt(Array(this.count+1).join("1"),2)}function ng(a){var b=!(a.Kf&1<<a.Oe);a.Oe--;return b}
function Ie(a,b,c,d){function e(b,d){var f=d-b;if(0==f)return null;if(1==f){var l=a[b],r=c?c(l):l;return new ag(r,l.S,!1,null,null)}var l=parseInt(f/2,10)+b,f=e(b,l),y=e(l+1,d),l=a[l],r=c?c(l):l;return new ag(r,l.S,!1,f,y)}a.sort(b);var f=function(b){function d(b,g){var k=r-b,y=r;r-=b;var y=e(k+1,y),k=a[k],G=c?c(k):k,y=new ag(G,k.S,g,null,y);f?f.left=y:l=y;f=y}for(var f=null,l=null,r=a.length,y=0;y<b.count;++y){var G=ng(b),td=Math.pow(2,b.count-(y+1));G?d(td,!1):(d(td,!1),d(td,!0))}return l}(new mg(a.length));
return null!==f?new Wf(d||b,f):new Wf(d||b)}function qe(a){return"number"===typeof a?"number:"+fd(a):"string:"+a}function oe(a){if(a.J()){var b=a.H();H("string"===typeof b||"number"===typeof b||"object"===typeof b&&xb(b,".sv"),"Priority must be a string or number.")}else H(a===ve||a.e(),"priority of unexpected type.");H(a===ve||a.C().e(),"Priority nodes can't have a priority of their own.")}var F=new P(new Wf(Fc),null,Ke);function og(){P.call(this,new Wf(Fc),F,Ke)}ja(og,P);h=og.prototype;
h.qc=function(a){return a===this?0:1};h.$=function(a){return a===this};h.C=function(){return this};h.R=function(){return F};h.e=function(){return!1};var ve=new og,te=new K("[MIN_NAME]",F),ze=new K("[MAX_NAME]",ve);function W(a,b,c){this.A=a;this.W=b;this.g=c}W.prototype.H=function(){A("Firebase.DataSnapshot.val",0,0,arguments.length);return this.A.H()};W.prototype.val=W.prototype.H;W.prototype.Re=function(){A("Firebase.DataSnapshot.exportVal",0,0,arguments.length);return this.A.H(!0)};W.prototype.exportVal=W.prototype.Re;W.prototype.Vf=function(){A("Firebase.DataSnapshot.exists",0,0,arguments.length);return!this.A.e()};W.prototype.exists=W.prototype.Vf;
W.prototype.k=function(a){A("Firebase.DataSnapshot.child",0,1,arguments.length);fa(a)&&(a=String(a));Mf("Firebase.DataSnapshot.child",a);var b=new L(a),c=this.W.k(b);return new W(this.A.Q(b),c,N)};W.prototype.child=W.prototype.k;W.prototype.Fa=function(a){A("Firebase.DataSnapshot.hasChild",1,1,arguments.length);Mf("Firebase.DataSnapshot.hasChild",a);var b=new L(a);return!this.A.Q(b).e()};W.prototype.hasChild=W.prototype.Fa;
W.prototype.C=function(){A("Firebase.DataSnapshot.getPriority",0,0,arguments.length);return this.A.C().H()};W.prototype.getPriority=W.prototype.C;W.prototype.forEach=function(a){A("Firebase.DataSnapshot.forEach",1,1,arguments.length);B("Firebase.DataSnapshot.forEach",1,a,!1);if(this.A.J())return!1;var b=this;return!!this.A.P(this.g,function(c,d){return a(new W(d,b.W.k(c),N))})};W.prototype.forEach=W.prototype.forEach;
W.prototype.gd=function(){A("Firebase.DataSnapshot.hasChildren",0,0,arguments.length);return this.A.J()?!1:!this.A.e()};W.prototype.hasChildren=W.prototype.gd;W.prototype.getKey=function(){A("Firebase.DataSnapshot.key",0,0,arguments.length);return this.W.getKey()};hd(W.prototype,"key",W.prototype.getKey);W.prototype.Db=function(){A("Firebase.DataSnapshot.numChildren",0,0,arguments.length);return this.A.Db()};W.prototype.numChildren=W.prototype.Db;
W.prototype.vb=function(){A("Firebase.DataSnapshot.ref",0,0,arguments.length);return this.W};hd(W.prototype,"ref",W.prototype.vb);function Vd(a,b){this.O=a;this.Id=b}function Sd(a,b,c,d){return new Vd(new wc(b,c,d),a.Id)}function Wd(a){return a.O.ea?a.O.j():null}Vd.prototype.w=function(){return this.Id};function xc(a){return a.Id.ea?a.Id.j():null};function pg(a,b){this.W=a;var c=a.n,d=new ce(c.g),c=S(c)?new ce(c.g):c.ya?new ie(c):new de(c);this.mf=new Md(c);var e=b.w(),f=b.O,g=d.za(F,e.j(),null),k=c.za(F,f.j(),null);this.Ma=new Vd(new wc(k,f.ea,c.Pa()),new wc(g,e.ea,d.Pa()));this.$a=[];this.Sf=new Hd(a)}function qg(a){return a.W}h=pg.prototype;h.w=function(){return this.Ma.w().j()};h.hb=function(a){var b=xc(this.Ma);return b&&(S(this.W.n)||!a.e()&&!b.R(J(a)).e())?b.Q(a):null};h.e=function(){return 0===this.$a.length};h.Mb=function(a){this.$a.push(a)};
h.kb=function(a,b){var c=[];if(b){H(null==a,"A cancel should cancel all event registrations.");var d=this.W.path;Ia(this.$a,function(a){(a=a.Me(b,d))&&c.push(a)})}if(a){for(var e=[],f=0;f<this.$a.length;++f){var g=this.$a[f];if(!g.matches(a))e.push(g);else if(a.Ye()){e=e.concat(this.$a.slice(f+1));break}}this.$a=e}else this.$a=[];return c};
h.fb=function(a,b,c){a.type===sd&&null!==a.source.Gb&&(H(xc(this.Ma),"We should always have a full cache before handling merges"),H(Wd(this.Ma),"Missing event cache, even though we have a server cache"));var d=this.Ma;a=this.mf.fb(d,a,b,c);b=this.mf;c=a.Od;H(c.O.j().wc(b.V.g),"Event snap not indexed");H(c.w().j().wc(b.V.g),"Server snap not indexed");H(Ac(a.Od.w())||!Ac(d.w()),"Once a server snap is complete, it should never go back");this.Ma=a.Od;return rg(this,a.Lf,a.Od.O.j(),null)};
function sg(a,b){var c=a.Ma.O,d=[];c.j().J()||c.j().P(N,function(a,b){d.push(new I("child_added",b,a))});c.ea&&d.push(yc(c.j()));return rg(a,d,c.j(),b)}function rg(a,b,c,d){return Id(a.Sf,b,c,d?[d]:a.$a)};function tg(a,b,c){this.Ob=a;this.qb=b;this.sb=c||null}h=tg.prototype;h.rf=function(a){return"value"===a};h.createEvent=function(a,b){var c=b.n.g;return new qc("value",this,new W(a.La,b.vb(),c))};h.Sb=function(a){var b=this.sb;if("cancel"===a.de()){H(this.qb,"Raising a cancel event on a listener with no cancel callback");var c=this.qb;return function(){c.call(b,a.error)}}var d=this.Ob;return function(){d.call(b,a.Jd)}};h.Me=function(a,b){return this.qb?new rc(this,a,b):null};
h.matches=function(a){return a instanceof tg?a.Ob&&this.Ob?a.Ob===this.Ob&&a.sb===this.sb:!0:!1};h.Ye=function(){return null!==this.Ob};function ug(a,b,c){this.ha=a;this.qb=b;this.sb=c}h=ug.prototype;h.rf=function(a){a="children_added"===a?"child_added":a;return("children_removed"===a?"child_removed":a)in this.ha};h.Me=function(a,b){return this.qb?new rc(this,a,b):null};
h.createEvent=function(a,b){H(null!=a.Ya,"Child events should have a childName.");var c=b.vb().k(a.Ya);return new qc(a.type,this,new W(a.La,c,b.n.g),a.Bd)};h.Sb=function(a){var b=this.sb;if("cancel"===a.de()){H(this.qb,"Raising a cancel event on a listener with no cancel callback");var c=this.qb;return function(){c.call(b,a.error)}}var d=this.ha[a.dd];return function(){d.call(b,a.Jd,a.Bd)}};
h.matches=function(a){if(a instanceof ug){if(!this.ha||!a.ha)return!0;if(this.sb===a.sb){var b=pa(a.ha);if(b===pa(this.ha)){if(1===b){var b=qa(a.ha),c=qa(this.ha);return c===b&&(!a.ha[b]||!this.ha[c]||a.ha[b]===this.ha[c])}return oa(this.ha,function(b,c){return a.ha[c]===b})}}}return!1};h.Ye=function(){return null!==this.ha};function X(a,b,c,d){this.u=a;this.path=b;this.n=c;this.Lc=d}
function vg(a){var b=null,c=null;a.la&&(b=fe(a));a.oa&&(c=he(a));if(a.g===be){if(a.la){if("[MIN_NAME]"!=ee(a))throw Error("Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().");if("string"!==typeof b)throw Error("Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.");}if(a.oa){if("[MAX_NAME]"!=ge(a))throw Error("Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().");if("string"!==
typeof c)throw Error("Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.");}}else if(a.g===N){if(null!=b&&!Ef(b)||null!=c&&!Ef(c))throw Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).");}else if(H(a.g instanceof ue||a.g===Ae,"unknown index type."),null!=b&&"object"===typeof b||null!=c&&"object"===typeof c)throw Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.");
}function wg(a){if(a.la&&a.oa&&a.ya&&(!a.ya||""===a.lc))throw Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.");}function xg(a,b){if(!0===a.Lc)throw Error(b+": You can't combine multiple orderBy calls.");}h=X.prototype;h.vb=function(){A("Query.ref",0,0,arguments.length);return new U(this.u,this.path)};
h.ec=function(a,b,c,d){A("Query.on",2,4,arguments.length);Kf("Query.on",a,!1);B("Query.on",2,b,!1);var e=yg("Query.on",c,d);if("value"===a)zg(this.u,this,new tg(b,e.cancel||null,e.Oa||null));else{var f={};f[a]=b;zg(this.u,this,new ug(f,e.cancel,e.Oa))}return b};
h.Gc=function(a,b,c){A("Query.off",0,3,arguments.length);Kf("Query.off",a,!0);B("Query.off",2,b,!0);Ab("Query.off",3,c);var d=null,e=null;"value"===a?d=new tg(b||null,null,c||null):a&&(b&&(e={},e[a]=b),d=new ug(e,null,c||null));e=this.u;d=".info"===J(this.path)?e.md.kb(this,d):e.K.kb(this,d);mc(e.da,this.path,d)};
h.jg=function(a,b){function c(k){f&&(f=!1,e.Gc(a,c),b&&b.call(d.Oa,k),g.resolve(k))}A("Query.once",1,4,arguments.length);Kf("Query.once",a,!1);B("Query.once",2,b,!0);var d=yg("Query.once",arguments[2],arguments[3]),e=this,f=!0,g=new Db;Fb(g.sa);this.ec(a,c,function(b){e.Gc(a,c);d.cancel&&d.cancel.call(d.Oa,b);g.reject(b)});return g.sa};
h.ke=function(a){A("Query.limitToFirst",1,1,arguments.length);if(!fa(a)||Math.floor(a)!==a||0>=a)throw Error("Query.limitToFirst: First argument must be a positive integer.");if(this.n.ya)throw Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new X(this.u,this.path,this.n.ke(a),this.Lc)};
h.le=function(a){A("Query.limitToLast",1,1,arguments.length);if(!fa(a)||Math.floor(a)!==a||0>=a)throw Error("Query.limitToLast: First argument must be a positive integer.");if(this.n.ya)throw Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new X(this.u,this.path,this.n.le(a),this.Lc)};
h.kg=function(a){A("Query.orderByChild",1,1,arguments.length);if("$key"===a)throw Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===a)throw Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===a)throw Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');Mf("Query.orderByChild",a);xg(this,"Query.orderByChild");var b=new L(a);if(b.e())throw Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");
b=new ue(b);b=Ee(this.n,b);vg(b);return new X(this.u,this.path,b,!0)};h.lg=function(){A("Query.orderByKey",0,0,arguments.length);xg(this,"Query.orderByKey");var a=Ee(this.n,be);vg(a);return new X(this.u,this.path,a,!0)};h.mg=function(){A("Query.orderByPriority",0,0,arguments.length);xg(this,"Query.orderByPriority");var a=Ee(this.n,N);vg(a);return new X(this.u,this.path,a,!0)};
h.ng=function(){A("Query.orderByValue",0,0,arguments.length);xg(this,"Query.orderByValue");var a=Ee(this.n,Ae);vg(a);return new X(this.u,this.path,a,!0)};h.Kd=function(a,b){A("Query.startAt",0,2,arguments.length);Ff("Query.startAt",a,this.path,!0);Lf("Query.startAt",b);var c=this.n.Kd(a,b);wg(c);vg(c);if(this.n.la)throw Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");p(a)||(b=a=null);return new X(this.u,this.path,c,this.Lc)};
h.cd=function(a,b){A("Query.endAt",0,2,arguments.length);Ff("Query.endAt",a,this.path,!0);Lf("Query.endAt",b);var c=this.n.cd(a,b);wg(c);vg(c);if(this.n.oa)throw Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new X(this.u,this.path,c,this.Lc)};
h.Rf=function(a,b){A("Query.equalTo",1,2,arguments.length);Ff("Query.equalTo",a,this.path,!1);Lf("Query.equalTo",b);if(this.n.la)throw Error("Query.equalTo: Starting point was already set (by another call to endAt or equalTo).");if(this.n.oa)throw Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.Kd(a,b).cd(a,b)};
h.toString=function(){A("Query.toString",0,0,arguments.length);for(var a=this.path,b="",c=a.Z;c<a.o.length;c++)""!==a.o[c]&&(b+="/"+encodeURIComponent(String(a.o[c])));return this.u.toString()+(b||"/")};h.ka=function(){var a=cd(Fe(this.n));return"{}"===a?"default":a};
h.isEqual=function(a){A("Query.isEqual",1,1,arguments.length);if(!(a instanceof X))throw Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var b=this.u===a.u,c=this.path.$(a.path),d=this.ka()===a.ka();return b&&c&&d};
function yg(a,b,c){var d={cancel:null,Oa:null};if(b&&c)d.cancel=b,B(a,3,d.cancel,!0),d.Oa=c,Ab(a,4,d.Oa);else if(b)if("object"===typeof b&&null!==b)d.Oa=b;else if("function"===typeof b)d.cancel=b;else throw Error(zb(a,3,!0)+" must either be a cancel callback or a context object.");return d}X.prototype.on=X.prototype.ec;X.prototype.off=X.prototype.Gc;X.prototype.once=X.prototype.jg;X.prototype.limitToFirst=X.prototype.ke;X.prototype.limitToLast=X.prototype.le;X.prototype.orderByChild=X.prototype.kg;
X.prototype.orderByKey=X.prototype.lg;X.prototype.orderByPriority=X.prototype.mg;X.prototype.orderByValue=X.prototype.ng;X.prototype.startAt=X.prototype.Kd;X.prototype.endAt=X.prototype.cd;X.prototype.equalTo=X.prototype.Rf;X.prototype.toString=X.prototype.toString;X.prototype.isEqual=X.prototype.isEqual;hd(X.prototype,"ref",X.prototype.vb);function Ag(a,b){this.value=a;this.children=b||Bg}var Bg=new Wf(function(a,b){return a===b?0:a<b?-1:1});function Cg(a){var b=Q;v(a,function(a,d){b=b.set(new L(d),a)});return b}h=Ag.prototype;h.e=function(){return null===this.value&&this.children.e()};function Dg(a,b,c){if(null!=a.value&&c(a.value))return{path:D,value:a.value};if(b.e())return null;var d=J(b);a=a.children.get(d);return null!==a?(b=Dg(a,E(b),c),null!=b?{path:(new L(d)).k(b.path),value:b.value}:null):null}
function Eg(a,b){return Dg(a,b,function(){return!0})}h.subtree=function(a){if(a.e())return this;var b=this.children.get(J(a));return null!==b?b.subtree(E(a)):Q};h.set=function(a,b){if(a.e())return new Ag(b,this.children);var c=J(a),d=(this.children.get(c)||Q).set(E(a),b),c=this.children.Qa(c,d);return new Ag(this.value,c)};
h.remove=function(a){if(a.e())return this.children.e()?Q:new Ag(null,this.children);var b=J(a),c=this.children.get(b);return c?(a=c.remove(E(a)),b=a.e()?this.children.remove(b):this.children.Qa(b,a),null===this.value&&b.e()?Q:new Ag(this.value,b)):this};h.get=function(a){if(a.e())return this.value;var b=this.children.get(J(a));return b?b.get(E(a)):null};
function ae(a,b,c){if(b.e())return c;var d=J(b);b=ae(a.children.get(d)||Q,E(b),c);d=b.e()?a.children.remove(d):a.children.Qa(d,b);return new Ag(a.value,d)}function Fg(a,b){return Gg(a,D,b)}function Gg(a,b,c){var d={};a.children.ia(function(a,f){d[a]=Gg(f,b.k(a),c)});return c(b,a.value,d)}function Hg(a,b,c){return Ig(a,b,D,c)}function Ig(a,b,c,d){var e=a.value?d(c,a.value):!1;if(e)return e;if(b.e())return null;e=J(b);return(a=a.children.get(e))?Ig(a,E(b),c.k(e),d):null}
function Jg(a,b,c){Kg(a,b,D,c)}function Kg(a,b,c,d){if(b.e())return a;a.value&&d(c,a.value);var e=J(b);return(a=a.children.get(e))?Kg(a,E(b),c.k(e),d):Q}function Zd(a,b){Lg(a,D,b)}function Lg(a,b,c){a.children.ia(function(a,e){Lg(e,b.k(a),c)});a.value&&c(b,a.value)}function Mg(a,b){a.children.ia(function(a,d){d.value&&b(a,d.value)})}var Q=new Ag(null);Ag.prototype.toString=function(){var a={};Zd(this,function(b,c){a[b.toString()]=c.toString()});return C(a)};function Ng(a,b,c){this.type=Rd;this.source=Og;this.path=a;this.Nb=b;this.Gd=c}Ng.prototype.Kc=function(a){if(this.path.e()){if(null!=this.Nb.value)return H(this.Nb.children.e(),"affectedTree should not have overlapping affected paths."),this;a=this.Nb.subtree(new L(a));return new Ng(D,a,this.Gd)}H(J(this.path)===a,"operationForChild called for unrelated child.");return new Ng(E(this.path),this.Nb,this.Gd)};
Ng.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" ack write revert="+this.Gd+" affectedTree="+this.Nb+")"};var Xb=0,sd=1,Rd=2,Zb=3;function Pg(a,b,c,d){this.be=a;this.Te=b;this.Gb=c;this.Ce=d;H(!d||b,"Tagged queries must be from server.")}var Og=new Pg(!0,!1,null,!1),Qg=new Pg(!1,!0,null,!1);Pg.prototype.toString=function(){return this.be?"user":this.Ce?"server(queryID="+this.Gb+")":"server"};function Rg(a){this.X=a}var Sg=new Rg(new Ag(null));function Tg(a,b,c){if(b.e())return new Rg(new Ag(c));var d=Eg(a.X,b);if(null!=d){var e=d.path,d=d.value;b=T(e,b);d=d.F(b,c);return new Rg(a.X.set(e,d))}a=ae(a.X,b,new Ag(c));return new Rg(a)}function Ug(a,b,c){var d=a;yb(c,function(a,c){d=Tg(d,b.k(a),c)});return d}Rg.prototype.Cd=function(a){if(a.e())return Sg;a=ae(this.X,a,Q);return new Rg(a)};function Vg(a,b){var c=Eg(a.X,b);return null!=c?a.X.get(c.path).Q(T(c.path,b)):null}
function Wg(a){var b=[],c=a.X.value;null!=c?c.J()||c.P(N,function(a,c){b.push(new K(a,c))}):a.X.children.ia(function(a,c){null!=c.value&&b.push(new K(a,c.value))});return b}function Xg(a,b){if(b.e())return a;var c=Vg(a,b);return null!=c?new Rg(new Ag(c)):new Rg(a.X.subtree(b))}Rg.prototype.e=function(){return this.X.e()};Rg.prototype.apply=function(a){return Yg(D,this.X,a)};
function Yg(a,b,c){if(null!=b.value)return c.F(a,b.value);var d=null;b.children.ia(function(b,f){".priority"===b?(H(null!==f.value,"Priority writes must always be leaf nodes"),d=f.value):c=Yg(a.k(b),f,c)});c.Q(a).e()||null===d||(c=c.F(a.k(".priority"),d));return c};function Zg(){this.Aa={}}h=Zg.prototype;h.e=function(){return wa(this.Aa)};h.fb=function(a,b,c){var d=a.source.Gb;if(null!==d)return d=z(this.Aa,d),H(null!=d,"SyncTree gave us an op for an invalid query."),d.fb(a,b,c);var e=[];v(this.Aa,function(d){e=e.concat(d.fb(a,b,c))});return e};h.Mb=function(a,b,c,d,e){var f=a.ka(),g=z(this.Aa,f);if(!g){var g=c.Ba(e?d:null),k=!1;g?k=!0:(g=d instanceof P?c.pc(d):F,k=!1);g=new pg(a,new Vd(new wc(g,k,!1),new wc(d,e,!1)));this.Aa[f]=g}g.Mb(b);return sg(g,b)};
h.kb=function(a,b,c){var d=a.ka(),e=[],f=[],g=null!=$g(this);if("default"===d){var k=this;v(this.Aa,function(a,d){f=f.concat(a.kb(b,c));a.e()&&(delete k.Aa[d],S(a.W.n)||e.push(a.W))})}else{var m=z(this.Aa,d);m&&(f=f.concat(m.kb(b,c)),m.e()&&(delete this.Aa[d],S(m.W.n)||e.push(m.W)))}g&&null==$g(this)&&e.push(new U(a.u,a.path));return{sg:e,Tf:f}};function ah(a){return Ja(ra(a.Aa),function(a){return!S(a.W.n)})}h.hb=function(a){var b=null;v(this.Aa,function(c){b=b||c.hb(a)});return b};
function bh(a,b){if(S(b.n))return $g(a);var c=b.ka();return z(a.Aa,c)}function $g(a){return va(a.Aa,function(a){return S(a.W.n)})||null};function ch(){this.T=Sg;this.ma=[];this.zc=-1}function dh(a,b){for(var c=0;c<a.ma.length;c++){var d=a.ma[c];if(d.Wc===b)return d}return null}h=ch.prototype;
h.Cd=function(a){var b=Oa(this.ma,function(b){return b.Wc===a});H(0<=b,"removeWrite called with nonexistent writeId.");var c=this.ma[b];this.ma.splice(b,1);for(var d=c.visible,e=!1,f=this.ma.length-1;d&&0<=f;){var g=this.ma[f];g.visible&&(f>=b&&eh(g,c.path)?d=!1:c.path.contains(g.path)&&(e=!0));f--}if(d){if(e)this.T=fh(this.ma,gh,D),this.zc=0<this.ma.length?this.ma[this.ma.length-1].Wc:-1;else if(c.Ia)this.T=this.T.Cd(c.path);else{var k=this;v(c.children,function(a,b){k.T=k.T.Cd(c.path.k(b))})}return!0}return!1};
h.Ba=function(a,b,c,d){if(c||d){var e=Xg(this.T,a);return!d&&e.e()?b:d||null!=b||null!=Vg(e,D)?(e=fh(this.ma,function(b){return(b.visible||d)&&(!c||!(0<=Ha(c,b.Wc)))&&(b.path.contains(a)||a.contains(b.path))},a),b=b||F,e.apply(b)):null}e=Vg(this.T,a);if(null!=e)return e;e=Xg(this.T,a);return e.e()?b:null!=b||null!=Vg(e,D)?(b=b||F,e.apply(b)):null};
h.pc=function(a,b){var c=F,d=Vg(this.T,a);if(d)d.J()||d.P(N,function(a,b){c=c.U(a,b)});else if(b){var e=Xg(this.T,a);b.P(N,function(a,b){var d=Xg(e,new L(a)).apply(b);c=c.U(a,d)});Ia(Wg(e),function(a){c=c.U(a.name,a.S)})}else e=Xg(this.T,a),Ia(Wg(e),function(a){c=c.U(a.name,a.S)});return c};h.Xc=function(a,b,c,d){H(c||d,"Either existingEventSnap or existingServerSnap must exist");a=a.k(b);if(null!=Vg(this.T,a))return null;a=Xg(this.T,a);return a.e()?d.Q(b):a.apply(d.Q(b))};
h.oc=function(a,b,c){a=a.k(b);var d=Vg(this.T,a);return null!=d?d:vc(c,b)?Xg(this.T,a).apply(c.j().R(b)):null};h.jc=function(a){return Vg(this.T,a)};h.Td=function(a,b,c,d,e,f){var g;a=Xg(this.T,a);g=Vg(a,D);if(null==g)if(null!=b)g=a.apply(b);else return[];g=g.mb(f);if(g.e()||g.J())return[];b=[];a=le(f);e=e?g.Yb(c,f):g.Wb(c,f);for(f=R(e);f&&b.length<d;)0!==a(f,c)&&b.push(f),f=R(e);return b};
function eh(a,b){return a.Ia?a.path.contains(b):!!ua(a.children,function(c,d){return a.path.k(d).contains(b)})}function gh(a){return a.visible}
function fh(a,b,c){for(var d=Sg,e=0;e<a.length;++e){var f=a[e];if(b(f)){var g=f.path;if(f.Ia)c.contains(g)?(g=T(c,g),d=Tg(d,g,f.Ia)):g.contains(c)&&(g=T(g,c),d=Tg(d,D,f.Ia.Q(g)));else if(f.children)if(c.contains(g))g=T(c,g),d=Ug(d,g,f.children);else{if(g.contains(c))if(g=T(g,c),g.e())d=Ug(d,D,f.children);else if(f=z(f.children,J(g)))f=f.Q(E(g)),d=Tg(d,D,f)}else throw Pc("WriteRecord should have .snap or .children");}}return d}function hh(a,b){this.Kb=a;this.X=b}h=hh.prototype;
h.Ba=function(a,b,c){return this.X.Ba(this.Kb,a,b,c)};h.pc=function(a){return this.X.pc(this.Kb,a)};h.Xc=function(a,b,c){return this.X.Xc(this.Kb,a,b,c)};h.jc=function(a){return this.X.jc(this.Kb.k(a))};h.Td=function(a,b,c,d,e){return this.X.Td(this.Kb,a,b,c,d,e)};h.oc=function(a,b){return this.X.oc(this.Kb,a,b)};h.k=function(a){return new hh(this.Kb.k(a),this.X)};function ih(){this.children={};this.Yc=0;this.value=null}function jh(a,b,c){this.sd=a?a:"";this.Ga=b?b:null;this.A=c?c:new ih}function kh(a,b){for(var c=b instanceof L?b:new L(b),d=a,e;null!==(e=J(c));)d=new jh(e,d,z(d.A.children,e)||new ih),c=E(c);return d}h=jh.prototype;h.Ea=function(){return this.A.value};function lh(a,b){H("undefined"!==typeof b,"Cannot set value to undefined");a.A.value=b;mh(a)}h.clear=function(){this.A.value=null;this.A.children={};this.A.Yc=0;mh(this)};
h.gd=function(){return 0<this.A.Yc};h.e=function(){return null===this.Ea()&&!this.gd()};h.P=function(a){var b=this;v(this.A.children,function(c,d){a(new jh(d,b,c))})};function nh(a,b,c,d){c&&!d&&b(a);a.P(function(a){nh(a,b,!0,d)});c&&d&&b(a)}function oh(a,b){for(var c=a.parent();null!==c&&!b(c);)c=c.parent()}h.path=function(){return new L(null===this.Ga?this.sd:this.Ga.path()+"/"+this.sd)};h.name=function(){return this.sd};h.parent=function(){return this.Ga};
function mh(a){if(null!==a.Ga){var b=a.Ga,c=a.sd,d=a.e(),e=xb(b.A.children,c);d&&e?(delete b.A.children[c],b.A.Yc--,mh(b)):d||e||(b.A.children[c]=a.A,b.A.Yc++,mh(b))}};function ph(a,b,c,d,e,f){this.id=qh++;this.f=Vc("p:"+this.id+":");this.nd={};this.aa={};this.qa=[];this.Mc=0;this.Ic=[];this.na=!1;this.Ua=1E3;this.qd=3E5;this.Fb=b;this.Hc=c;this.se=d;this.M=a;this.nb=this.Ha=this.Bb=this.xe=null;this.Rd=e;this.ae=!1;this.he=0;this.He=f||null;this.tb=null;this.Lb=!1;this.Ed={};this.tg=0;this.Se=!0;this.yc=this.je=null;rh(this,0);Uf.Ub().ec("visible",this.ig,this);-1===a.host.indexOf("fblocal")&&Tf.Ub().ec("online",this.hg,this)}var qh=0,sh=0;h=ph.prototype;
h.va=function(a,b,c){var d=++this.tg;a={r:d,a:a,b:b};this.f(C(a));H(this.na,"sendRequest call when we're not connected not allowed.");this.Ha.va(a);c&&(this.Ed[d]=c)};h.af=function(a,b,c,d){var e=a.ka(),f=a.path.toString();this.f("Listen called for "+f+" "+e);this.aa[f]=this.aa[f]||{};H(od(a.n)||!S(a.n),"listen() called for non-default but complete query");H(!this.aa[f][e],"listen() called twice for same path/queryId.");a={G:d,hd:b,pg:a,tag:c};this.aa[f][e]=a;this.na&&th(this,a)};
function th(a,b){var c=b.pg,d=c.path.toString(),e=c.ka();a.f("Listen on "+d+" for "+e);var f={p:d};b.tag&&(f.q=Fe(c.n),f.t=b.tag);f.h=b.hd();a.va("q",f,function(f){var k=f.d,m=f.s;if(k&&"object"===typeof k&&xb(k,"w")){var l=z(k,"w");da(l)&&0<=Ha(l,"no_index")&&O("Using an unspecified index. Consider adding "+('".indexOn": "'+c.n.g.toString()+'"')+" at "+c.path.toString()+" to your security rules for better performance")}(a.aa[d]&&a.aa[d][e])===b&&(a.f("listen response",f),"ok"!==m&&uh(a,d,e),b.G&&
b.G(m,k))})}h.of=function(a){this.nb=a;this.f("Auth token refreshed");this.nb?vh(this):this.na&&this.va("unauth",{},function(){});if(a&&40===a.length||ld(a))this.f("Admin auth credential detected.  Reducing max reconnect time."),this.qd=3E4};function vh(a){if(a.na&&a.nb){var b=a.nb,c=kd(b)?"auth":"gauth",d={cred:b};a.He&&(d.authvar=a.He);a.va(c,d,function(c){var d=c.s;c=c.d||"error";a.nb===b&&("ok"===d?a.he=0:wh(a,d,c))})}}
h.Df=function(a,b){var c=a.path.toString(),d=a.ka();this.f("Unlisten called for "+c+" "+d);H(od(a.n)||!S(a.n),"unlisten() called for non-default but complete query");if(uh(this,c,d)&&this.na){var e=Fe(a.n);this.f("Unlisten on "+c+" for "+d);c={p:c};b&&(c.q=e,c.t=b);this.va("n",c)}};h.pe=function(a,b,c){this.na?xh(this,"o",a,b,c):this.Ic.push({ue:a,action:"o",data:b,G:c})};h.ff=function(a,b,c){this.na?xh(this,"om",a,b,c):this.Ic.push({ue:a,action:"om",data:b,G:c})};
h.vd=function(a,b){this.na?xh(this,"oc",a,null,b):this.Ic.push({ue:a,action:"oc",data:null,G:b})};function xh(a,b,c,d,e){c={p:c,d:d};a.f("onDisconnect "+b,c);a.va(b,c,function(a){e&&setTimeout(function(){e(a.s,a.d)},Math.floor(0))})}h.put=function(a,b,c,d){yh(this,"p",a,b,c,d)};h.bf=function(a,b,c,d){yh(this,"m",a,b,c,d)};function yh(a,b,c,d,e,f){d={p:c,d:d};p(f)&&(d.h=f);a.qa.push({action:b,qf:d,G:e});a.Mc++;b=a.qa.length-1;a.na?zh(a,b):a.f("Buffering put: "+c)}
function zh(a,b){var c=a.qa[b].action,d=a.qa[b].qf,e=a.qa[b].G;a.qa[b].qg=a.na;a.va(c,d,function(d){a.f(c+" response",d);delete a.qa[b];a.Mc--;0===a.Mc&&(a.qa=[]);e&&e(d.s,d.d)})}h.we=function(a){this.na&&(a={c:a},this.f("reportStats",a),this.va("s",a,function(a){"ok"!==a.s&&this.f("reportStats","Error sending stats: "+a.d)}))};
h.ud=function(a){if("r"in a){this.f("from server: "+C(a));var b=a.r,c=this.Ed[b];c&&(delete this.Ed[b],c(a.b))}else{if("error"in a)throw"A server-side error has occurred: "+a.error;"a"in a&&(b=a.a,a=a.b,this.f("handleServerMessage",b,a),"d"===b?this.Fb(a.p,a.d,!1,a.t):"m"===b?this.Fb(a.p,a.d,!0,a.t):"c"===b?Ah(this,a.p,a.q):"ac"===b?wh(this,a.s,a.d):"sd"===b?this.xe?this.xe(a):"msg"in a&&"undefined"!==typeof console&&console.log("FIREBASE: "+a.msg.replace("\n","\nFIREBASE: ")):Wc("Unrecognized action received from server: "+
C(b)+"\nAre you using the latest client?"))}};h.Jc=function(a,b){this.f("connection ready");this.na=!0;this.yc=(new Date).getTime();this.se({serverTimeOffset:a-(new Date).getTime()});this.Bb=b;if(this.Se){var c={};c["sdk.js."+firebase.SDK_VERSION.replace(/\./g,"-")]=1;Mb()?c["framework.cordova"]=1:"object"===typeof navigator&&"ReactNative"===navigator.product&&(c["framework.reactnative"]=1);this.we(c)}Bh(this);this.Se=!1;this.Hc(!0)};
function rh(a,b){H(!a.Ha,"Scheduling a connect when we're already connected/ing?");a.tb&&clearTimeout(a.tb);a.tb=setTimeout(function(){a.tb=null;Ch(a)},Math.floor(b))}h.ig=function(a){a&&!this.Lb&&this.Ua===this.qd&&(this.f("Window became visible.  Reducing delay."),this.Ua=1E3,this.Ha||rh(this,0));this.Lb=a};h.hg=function(a){a?(this.f("Browser went online."),this.Ua=1E3,this.Ha||rh(this,0)):(this.f("Browser went offline.  Killing connection."),this.Ha&&this.Ha.close())};
h.hf=function(){this.f("data client disconnected");this.na=!1;this.Ha=null;for(var a=0;a<this.qa.length;a++){var b=this.qa[a];b&&"h"in b.qf&&b.qg&&(b.G&&b.G("disconnect"),delete this.qa[a],this.Mc--)}0===this.Mc&&(this.qa=[]);this.Ed={};Dh(this)&&(this.Lb?this.yc&&(3E4<(new Date).getTime()-this.yc&&(this.Ua=1E3),this.yc=null):(this.f("Window isn't visible.  Delaying reconnect."),this.Ua=this.qd,this.je=(new Date).getTime()),a=Math.max(0,this.Ua-((new Date).getTime()-this.je)),a*=Math.random(),this.f("Trying to reconnect in "+
a+"ms"),rh(this,a),this.Ua=Math.min(this.qd,1.3*this.Ua));this.Hc(!1)};
function Ch(a){if(Dh(a)){a.f("Making a connection attempt");a.je=(new Date).getTime();a.yc=null;var b=u(a.ud,a),c=u(a.Jc,a),d=u(a.hf,a),e=a.id+":"+sh++,f=a.Bb,g=!1,k=null,m=function(){k?k.close():(g=!0,d())};a.Ha={close:m,va:function(a){H(k,"sendRequest call when we're not connected not allowed.");k.va(a)}};var l=a.ae;a.ae=!1;a.Rd.getToken(l).then(function(l){g?ac("getToken() completed but was canceled"):(ac("getToken() completed. Creating connection."),a.nb=l&&l.accessToken,k=new cf(e,a.M,b,c,d,
function(b){O(b+" ("+a.M.toString()+")");a.bb("server_kill")},f))}).then(null,function(b){a.f("Failed to get token: "+b);g||m()})}}h.bb=function(a){ac("Interrupting connection for reason: "+a);this.nd[a]=!0;this.Ha?this.Ha.close():(this.tb&&(clearTimeout(this.tb),this.tb=null),this.na&&this.hf())};h.ic=function(a){ac("Resuming connection for reason: "+a);delete this.nd[a];wa(this.nd)&&(this.Ua=1E3,this.Ha||rh(this,0))};
function Ah(a,b,c){c=c?Ka(c,function(a){return cd(a)}).join("$"):"default";(a=uh(a,b,c))&&a.G&&a.G("permission_denied")}function uh(a,b,c){b=(new L(b)).toString();var d;p(a.aa[b])?(d=a.aa[b][c],delete a.aa[b][c],0===pa(a.aa[b])&&delete a.aa[b]):d=void 0;return d}
function wh(a,b,c){ac("Auth token revoked: "+b+"/"+c);a.nb=null;a.ae=!0;a.Ha.close();"invalid_token"===b&&(a.he++,3<=a.he&&(a.Ua=3E4,O("Provided authentication credentials are invalid. This usually indicates your FirebaseApp instance was not initialized correctly. Make sure your apiKey and databaseURL match the values provided for your app at https://console.firebase.google.com/, or if you're using a service account, make sure it's authorized to access the specified databaseURL and is from the correct project.")))}
function Bh(a){vh(a);v(a.aa,function(b){v(b,function(b){th(a,b)})});for(var b=0;b<a.qa.length;b++)a.qa[b]&&zh(a,b);for(;a.Ic.length;)b=a.Ic.shift(),xh(a,b.action,b.ue,b.data,b.G)}function Dh(a){var b;b=Tf.Ub().fc;return wa(a.nd)&&b};var Y={Xf:function(){Oe=Bd=!0}};Y.forceLongPolling=Y.Xf;Y.Yf=function(){Pe=!0};Y.forceWebSockets=Y.Yf;Y.dg=function(){return Ad.isAvailable()};Y.isWebSocketsAvailable=Y.dg;Y.wg=function(a,b){a.u.Ta.xe=b};Y.setSecurityDebugCallback=Y.wg;Y.ze=function(a,b){a.u.ze(b)};Y.stats=Y.ze;Y.Ae=function(a,b){a.u.Ae(b)};Y.statsIncrementCounter=Y.Ae;Y.bd=function(a){return a.u.bd};Y.dataUpdateCount=Y.bd;Y.cg=function(a,b){a.u.ge=b};Y.interceptServerData=Y.cg;function Eh(a){this.xa=Q;this.jb=new ch;this.Be={};this.gc={};this.Ac=a}function Fh(a,b,c,d,e){var f=a.jb,g=e;H(d>f.zc,"Stacking an older write on top of newer ones");p(g)||(g=!0);f.ma.push({path:b,Ia:c,Wc:d,visible:g});g&&(f.T=Tg(f.T,b,c));f.zc=d;return e?Gh(a,new Wb(Og,b,c)):[]}function Hh(a,b,c,d){var e=a.jb;H(d>e.zc,"Stacking an older merge on top of newer ones");e.ma.push({path:b,children:c,Wc:d,visible:!0});e.T=Ug(e.T,b,c);e.zc=d;c=Cg(c);return Gh(a,new rd(Og,b,c))}
function Ih(a,b,c){c=c||!1;var d=dh(a.jb,b);if(a.jb.Cd(b)){var e=Q;null!=d.Ia?e=e.set(D,!0):yb(d.children,function(a,b){e=e.set(new L(a),b)});return Gh(a,new Ng(d.path,e,c))}return[]}function Jh(a,b,c){c=Cg(c);return Gh(a,new rd(Qg,b,c))}function Kh(a,b,c,d){d=Lh(a,d);if(null!=d){var e=Mh(d);d=e.path;e=e.Gb;b=T(d,b);c=new Wb(new Pg(!1,!0,e,!0),b,c);return Nh(a,d,c)}return[]}
function Oh(a,b,c,d){if(d=Lh(a,d)){var e=Mh(d);d=e.path;e=e.Gb;b=T(d,b);c=Cg(c);c=new rd(new Pg(!1,!0,e,!0),b,c);return Nh(a,d,c)}return[]}
Eh.prototype.Mb=function(a,b){var c=a.path,d=null,e=!1;Jg(this.xa,c,function(a,b){var f=T(a,c);d=d||b.hb(f);e=e||null!=$g(b)});var f=this.xa.get(c);f?(e=e||null!=$g(f),d=d||f.hb(D)):(f=new Zg,this.xa=this.xa.set(c,f));var g;null!=d?g=!0:(g=!1,d=F,Mg(this.xa.subtree(c),function(a,b){var c=b.hb(D);c&&(d=d.U(a,c))}));var k=null!=bh(f,a);if(!k&&!S(a.n)){var m=Ph(a);H(!(m in this.gc),"View does not exist, but we have a tag");var l=Qh++;this.gc[m]=l;this.Be["_"+l]=m}g=f.Mb(a,b,new hh(c,this.jb),d,g);k||
e||(f=bh(f,a),g=g.concat(Rh(this,a,f)));return g};
Eh.prototype.kb=function(a,b,c){var d=a.path,e=this.xa.get(d),f=[];if(e&&("default"===a.ka()||null!=bh(e,a))){f=e.kb(a,b,c);e.e()&&(this.xa=this.xa.remove(d));e=f.sg;f=f.Tf;b=-1!==Oa(e,function(a){return S(a.n)});var g=Hg(this.xa,d,function(a,b){return null!=$g(b)});if(b&&!g&&(d=this.xa.subtree(d),!d.e()))for(var d=Sh(d),k=0;k<d.length;++k){var m=d[k],l=m.W,m=Th(this,m);this.Ac.ye(Uh(l),Vh(this,l),m.hd,m.G)}if(!g&&0<e.length&&!c)if(b)this.Ac.Ld(Uh(a),null);else{var r=this;Ia(e,function(a){a.ka();
var b=r.gc[Ph(a)];r.Ac.Ld(Uh(a),b)})}Wh(this,e)}return f};Eh.prototype.Ba=function(a,b){var c=this.jb,d=Hg(this.xa,a,function(b,c){var d=T(b,a);if(d=c.hb(d))return d});return c.Ba(a,d,b,!0)};function Sh(a){return Fg(a,function(a,c,d){if(c&&null!=$g(c))return[$g(c)];var e=[];c&&(e=ah(c));v(d,function(a){e=e.concat(a)});return e})}function Wh(a,b){for(var c=0;c<b.length;++c){var d=b[c];if(!S(d.n)){var d=Ph(d),e=a.gc[d];delete a.gc[d];delete a.Be["_"+e]}}}
function Uh(a){return S(a.n)&&!od(a.n)?a.vb():a}function Rh(a,b,c){var d=b.path,e=Vh(a,b);c=Th(a,c);b=a.Ac.ye(Uh(b),e,c.hd,c.G);d=a.xa.subtree(d);if(e)H(null==$g(d.value),"If we're adding a query, it shouldn't be shadowed");else for(e=Fg(d,function(a,b,c){if(!a.e()&&b&&null!=$g(b))return[qg($g(b))];var d=[];b&&(d=d.concat(Ka(ah(b),function(a){return a.W})));v(c,function(a){d=d.concat(a)});return d}),d=0;d<e.length;++d)c=e[d],a.Ac.Ld(Uh(c),Vh(a,c));return b}
function Th(a,b){var c=b.W,d=Vh(a,c);return{hd:function(){return(b.w()||F).hash()},G:function(b){if("ok"===b){if(d){var f=c.path;if(b=Lh(a,d)){var g=Mh(b);b=g.path;g=g.Gb;f=T(b,f);f=new Yb(new Pg(!1,!0,g,!0),f);b=Nh(a,b,f)}else b=[]}else b=Gh(a,new Yb(Qg,c.path));return b}f="Unknown Error";"too_big"===b?f="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==b?f="Client doesn't have permission to access the desired data.":"unavailable"==b&&
(f="The service is unavailable");f=Error(b+" at "+c.path.toString()+": "+f);f.code=b.toUpperCase();return a.kb(c,null,f)}}}function Ph(a){return a.path.toString()+"$"+a.ka()}function Mh(a){var b=a.indexOf("$");H(-1!==b&&b<a.length-1,"Bad queryKey.");return{Gb:a.substr(b+1),path:new L(a.substr(0,b))}}function Lh(a,b){var c=a.Be,d="_"+b;return d in c?c[d]:void 0}function Vh(a,b){var c=Ph(b);return z(a.gc,c)}var Qh=1;
function Nh(a,b,c){var d=a.xa.get(b);H(d,"Missing sync point for query tag that we're tracking");return d.fb(c,new hh(b,a.jb),null)}function Gh(a,b){return Xh(a,b,a.xa,null,new hh(D,a.jb))}function Xh(a,b,c,d,e){if(b.path.e())return Yh(a,b,c,d,e);var f=c.get(D);null==d&&null!=f&&(d=f.hb(D));var g=[],k=J(b.path),m=b.Kc(k);if((c=c.children.get(k))&&m)var l=d?d.R(k):null,k=e.k(k),g=g.concat(Xh(a,m,c,l,k));f&&(g=g.concat(f.fb(b,e,d)));return g}
function Yh(a,b,c,d,e){var f=c.get(D);null==d&&null!=f&&(d=f.hb(D));var g=[];c.children.ia(function(c,f){var l=d?d.R(c):null,r=e.k(c),y=b.Kc(c);y&&(g=g.concat(Yh(a,y,f,l,r)))});f&&(g=g.concat(f.fb(b,e,d)));return g};function uf(a,b,c){this.app=c;var d=new $b(c);this.M=a;this.Wa=xd(a);this.Sc=null;this.da=new jc;this.td=1;this.Ta=null;if(b||0<=("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i))this.wa=new md(this.M,u(this.Fb,this),d),setTimeout(u(this.Hc,this,!0),0);else{b=c.options.databaseAuthVariableOverride||null;if(null!==b){if("object"!==ca(b))throw Error("Only objects are supported for option databaseAuthVariableOverride");
try{C(b)}catch(e){throw Error("Invalid authOverride provided: "+e);}}this.wa=this.Ta=new ph(this.M,u(this.Fb,this),u(this.Hc,this),u(this.se,this),d,b)}var f=this;bc(d,function(a){f.wa.of(a)});this.zg=yd(a,u(function(){return new ud(this.Wa,this.wa)},this));this.kc=new jh;this.fe=new cc;this.md=new Eh({ye:function(a,b,c,d){b=[];c=f.fe.j(a.path);c.e()||(b=Gh(f.md,new Wb(Qg,a.path,c)),setTimeout(function(){d("ok")},0));return b},Ld:aa});Zh(this,"connected",!1);this.ja=new Jc;this.Za=new tf(this);this.bd=
0;this.ge=null;this.K=new Eh({ye:function(a,b,c,d){f.wa.af(a,c,b,function(b,c){var e=d(b,c);oc(f.da,a.path,e)});return[]},Ld:function(a,b){f.wa.Df(a,b)}})}h=uf.prototype;h.toString=function(){return(this.M.Pc?"https://":"http://")+this.M.host};h.name=function(){return this.M.ne};function $h(a){a=a.fe.j(new L(".info/serverTimeOffset")).H()||0;return(new Date).getTime()+a}function ai(a){a=a={timestamp:$h(a)};a.timestamp=a.timestamp||(new Date).getTime();return a}
h.Fb=function(a,b,c,d){this.bd++;var e=new L(a);b=this.ge?this.ge(a,b):b;a=[];d?c?(b=na(b,function(a){return M(a)}),a=Oh(this.K,e,b,d)):(b=M(b),a=Kh(this.K,e,b,d)):c?(d=na(b,function(a){return M(a)}),a=Jh(this.K,e,d)):(d=M(b),a=Gh(this.K,new Wb(Qg,e,d)));d=e;0<a.length&&(d=bi(this,e));oc(this.da,d,a)};h.Hc=function(a){Zh(this,"connected",a);!1===a&&ci(this)};h.se=function(a){var b=this;ed(a,function(a,d){Zh(b,d,a)})};
function Zh(a,b,c){b=new L("/.info/"+b);c=M(c);var d=a.fe;d.Hd=d.Hd.F(b,c);c=Gh(a.md,new Wb(Qg,b,c));oc(a.da,b,c)}h.Ib=function(a,b,c,d){this.f("set",{path:a.toString(),value:b,Jg:c});var e=ai(this);b=M(b,c);var e=Mc(b,e),f=this.td++,e=Fh(this.K,a,e,f,!0);kc(this.da,e);var g=this;this.wa.put(a.toString(),b.H(!0),function(b,c){var e="ok"===b;e||O("set at "+a+" failed: "+b);e=Ih(g.K,f,!e);oc(g.da,a,e);di(d,b,c)});e=ei(this,a);bi(this,e);oc(this.da,e,[])};
h.update=function(a,b,c){this.f("update",{path:a.toString(),value:b});var d=!0,e=ai(this),f={};v(b,function(a,b){d=!1;var c=M(a);f[b]=Mc(c,e)});if(d)ac("update() called with empty data.  Don't do anything."),di(c,"ok");else{var g=this.td++,k=Hh(this.K,a,f,g);kc(this.da,k);var m=this;this.wa.bf(a.toString(),b,function(b,d){var e="ok"===b;e||O("update at "+a+" failed: "+b);var e=Ih(m.K,g,!e),f=a;0<e.length&&(f=bi(m,a));oc(m.da,f,e);di(c,b,d)});v(b,function(b,c){var d=ei(m,a.k(c));bi(m,d)});oc(this.da,
a,[])}};function ci(a){a.f("onDisconnectEvents");var b=ai(a),c=[];Kc(Ic(a.ja,b),D,function(b,e){c=c.concat(Gh(a.K,new Wb(Qg,b,e)));var f=ei(a,b);bi(a,f)});a.ja=new Jc;oc(a.da,D,c)}h.vd=function(a,b){var c=this;this.wa.vd(a.toString(),function(d,e){"ok"===d&&Af(c.ja,a);di(b,d,e)})};function Of(a,b,c,d){var e=M(c);a.wa.pe(b.toString(),e.H(!0),function(c,g){"ok"===c&&Lc(a.ja,b,e);di(d,c,g)})}
function Pf(a,b,c,d,e){var f=M(c,d);a.wa.pe(b.toString(),f.H(!0),function(c,d){"ok"===c&&Lc(a.ja,b,f);di(e,c,d)})}function Qf(a,b,c,d){var e=!0,f;for(f in c)e=!1;e?(ac("onDisconnect().update() called with empty data.  Don't do anything."),di(d,"ok")):a.wa.ff(b.toString(),c,function(e,f){if("ok"===e)for(var m in c){var l=M(c[m]);Lc(a.ja,b.k(m),l)}di(d,e,f)})}function zg(a,b,c){c=".info"===J(b.path)?a.md.Mb(b,c):a.K.Mb(b,c);mc(a.da,b.path,c)}h.bb=function(){this.Ta&&this.Ta.bb("repo_interrupt")};
h.ic=function(){this.Ta&&this.Ta.ic("repo_interrupt")};h.ze=function(a){if("undefined"!==typeof console){a?(this.Sc||(this.Sc=new ic(this.Wa)),a=this.Sc.get()):a=this.Wa.get();var b=La(sa(a),function(a,b){return Math.max(b.length,a)},0),c;for(c in a){for(var d=a[c],e=c.length;e<b+2;e++)c+=" ";console.log(c+d)}}};h.Ae=function(a){hc(this.Wa,a);this.zg.yf[a]=!0};h.f=function(a){var b="";this.Ta&&(b=this.Ta.id+":");ac(b,arguments)};
function di(a,b,c){a&&Qb(function(){if("ok"==b)a(null);else{var d=(b||"error").toUpperCase(),e=d;c&&(e+=": "+c);e=Error(e);e.code=d;a(e)}})};function fi(a,b,c,d,e){function f(){}a.f("transaction on "+b);var g=new U(a,b);g.ec("value",f);c={path:b,update:c,G:d,status:null,kf:Oc(),Ge:e,tf:0,Nd:function(){g.Gc("value",f)},Pd:null,Da:null,Zc:null,$c:null,ad:null};d=a.K.Ba(b,void 0)||F;c.Zc=d;d=c.update(d.H());if(p(d)){Gf("transaction failed: Data returned ",d,c.path);c.status=1;e=kh(a.kc,b);var k=e.Ea()||[];k.push(c);lh(e,k);"object"===typeof d&&null!==d&&xb(d,".priority")?(k=z(d,".priority"),H(Ef(k),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):
k=(a.K.Ba(b)||F).C().H();e=ai(a);d=M(d,k);e=Mc(d,e);c.$c=d;c.ad=e;c.Da=a.td++;c=Fh(a.K,b,e,c.Da,c.Ge);oc(a.da,b,c);gi(a)}else c.Nd(),c.$c=null,c.ad=null,c.G&&(a=new W(c.Zc,new U(a,c.path),N),c.G(null,!1,a))}function gi(a,b){var c=b||a.kc;b||hi(a,c);if(null!==c.Ea()){var d=ii(a,c);H(0<d.length,"Sending zero length transaction queue");Ma(d,function(a){return 1===a.status})&&ji(a,c.path(),d)}else c.gd()&&c.P(function(b){gi(a,b)})}
function ji(a,b,c){for(var d=Ka(c,function(a){return a.Da}),e=a.K.Ba(b,d)||F,d=e,e=e.hash(),f=0;f<c.length;f++){var g=c[f];H(1===g.status,"tryToSendTransactionQueue_: items in queue should all be run.");g.status=2;g.tf++;var k=T(b,g.path),d=d.F(k,g.$c)}d=d.H(!0);a.wa.put(b.toString(),d,function(d){a.f("transaction put response",{path:b.toString(),status:d});var e=[];if("ok"===d){d=[];for(f=0;f<c.length;f++){c[f].status=3;e=e.concat(Ih(a.K,c[f].Da));if(c[f].G){var g=c[f].ad,k=new U(a,c[f].path);d.push(u(c[f].G,
null,null,!0,new W(g,k,N)))}c[f].Nd()}hi(a,kh(a.kc,b));gi(a);oc(a.da,b,e);for(f=0;f<d.length;f++)Qb(d[f])}else{if("datastale"===d)for(f=0;f<c.length;f++)c[f].status=4===c[f].status?5:1;else for(O("transaction at "+b.toString()+" failed: "+d),f=0;f<c.length;f++)c[f].status=5,c[f].Pd=d;bi(a,b)}},e)}function bi(a,b){var c=ki(a,b),d=c.path(),c=ii(a,c);li(a,c,d);return d}
function li(a,b,c){if(0!==b.length){for(var d=[],e=[],f=Ja(b,function(a){return 1===a.status}),f=Ka(f,function(a){return a.Da}),g=0;g<b.length;g++){var k=b[g],m=T(c,k.path),l=!1,r;H(null!==m,"rerunTransactionsUnderNode_: relativePath should not be null.");if(5===k.status)l=!0,r=k.Pd,e=e.concat(Ih(a.K,k.Da,!0));else if(1===k.status)if(25<=k.tf)l=!0,r="maxretry",e=e.concat(Ih(a.K,k.Da,!0));else{var y=a.K.Ba(k.path,f)||F;k.Zc=y;var G=b[g].update(y.H());p(G)?(Gf("transaction failed: Data returned ",G,
k.path),m=M(G),"object"===typeof G&&null!=G&&xb(G,".priority")||(m=m.ga(y.C())),y=k.Da,G=ai(a),G=Mc(m,G),k.$c=m,k.ad=G,k.Da=a.td++,Pa(f,y),e=e.concat(Fh(a.K,k.path,G,k.Da,k.Ge)),e=e.concat(Ih(a.K,y,!0))):(l=!0,r="nodata",e=e.concat(Ih(a.K,k.Da,!0)))}oc(a.da,c,e);e=[];l&&(b[g].status=3,setTimeout(b[g].Nd,Math.floor(0)),b[g].G&&("nodata"===r?(k=new U(a,b[g].path),d.push(u(b[g].G,null,null,!1,new W(b[g].Zc,k,N)))):d.push(u(b[g].G,null,Error(r),!1,null))))}hi(a,a.kc);for(g=0;g<d.length;g++)Qb(d[g]);gi(a)}}
function ki(a,b){for(var c,d=a.kc;null!==(c=J(b))&&null===d.Ea();)d=kh(d,c),b=E(b);return d}function ii(a,b){var c=[];mi(a,b,c);c.sort(function(a,b){return a.kf-b.kf});return c}function mi(a,b,c){var d=b.Ea();if(null!==d)for(var e=0;e<d.length;e++)c.push(d[e]);b.P(function(b){mi(a,b,c)})}function hi(a,b){var c=b.Ea();if(c){for(var d=0,e=0;e<c.length;e++)3!==c[e].status&&(c[d]=c[e],d++);c.length=d;lh(b,0<c.length?c:null)}b.P(function(b){hi(a,b)})}
function ei(a,b){var c=ki(a,b).path(),d=kh(a.kc,b);oh(d,function(b){ni(a,b)});ni(a,d);nh(d,function(b){ni(a,b)});return c}
function ni(a,b){var c=b.Ea();if(null!==c){for(var d=[],e=[],f=-1,g=0;g<c.length;g++)4!==c[g].status&&(2===c[g].status?(H(f===g-1,"All SENT items should be at beginning of queue."),f=g,c[g].status=4,c[g].Pd="set"):(H(1===c[g].status,"Unexpected transaction status in abort"),c[g].Nd(),e=e.concat(Ih(a.K,c[g].Da,!0)),c[g].G&&d.push(u(c[g].G,null,Error("set"),!1,null))));-1===f?lh(b,null):c.length=f+1;oc(a.da,b.path(),e);for(g=0;g<d.length;g++)Qb(d[g])}};function zf(){this.lb={};this.Ef=!1}zf.prototype.bb=function(){for(var a in this.lb)this.lb[a].bb()};zf.prototype.ic=function(){for(var a in this.lb)this.lb[a].ic()};zf.prototype.$d=function(a){this.Ef=a};ba(zf);zf.prototype.interrupt=zf.prototype.bb;zf.prototype.resume=zf.prototype.ic;var Z={};Z.mc=ph;Z.DataConnection=Z.mc;ph.prototype.yg=function(a,b){this.va("q",{p:a},b)};Z.mc.prototype.simpleListen=Z.mc.prototype.yg;ph.prototype.Qf=function(a,b){this.va("echo",{d:a},b)};Z.mc.prototype.echo=Z.mc.prototype.Qf;ph.prototype.interrupt=ph.prototype.bb;Z.Hf=cf;Z.RealTimeConnection=Z.Hf;cf.prototype.sendRequest=cf.prototype.va;cf.prototype.close=cf.prototype.close;
Z.bg=function(a){var b=ph.prototype.put;ph.prototype.put=function(c,d,e,f){p(f)&&(f=a());b.call(this,c,d,e,f)};return function(){ph.prototype.put=b}};Z.hijackHash=Z.bg;Z.Gf=dc;Z.ConnectionTarget=Z.Gf;Z.ka=function(a){return a.ka()};Z.queryIdentifier=Z.ka;Z.eg=function(a){return a.u.Ta.aa};Z.listens=Z.eg;Z.$d=function(a){zf.Ub().$d(a)};Z.forceRestClient=Z.$d;Z.Context=zf;function U(a,b){if(!(a instanceof uf))throw Error("new Firebase() no longer supported - use app.database().");X.call(this,a,b,Ce,!1);this.then=void 0;this["catch"]=void 0}ja(U,X);h=U.prototype;h.getKey=function(){A("Firebase.key",0,0,arguments.length);return this.path.e()?null:Yd(this.path)};
h.k=function(a){A("Firebase.child",1,1,arguments.length);if(fa(a))a=String(a);else if(!(a instanceof L))if(null===J(this.path)){var b=a;b&&(b=b.replace(/^\/*\.info(\/|$)/,"/"));Mf("Firebase.child",b)}else Mf("Firebase.child",a);return new U(this.u,this.path.k(a))};h.getParent=function(){A("Firebase.parent",0,0,arguments.length);var a=this.path.parent();return null===a?null:new U(this.u,a)};
h.Zf=function(){A("Firebase.ref",0,0,arguments.length);for(var a=this;null!==a.getParent();)a=a.getParent();return a};h.Pf=function(){return this.u.Za};h.set=function(a,b){A("Firebase.set",1,2,arguments.length);Nf("Firebase.set",this.path);Ff("Firebase.set",a,this.path,!1);B("Firebase.set",2,b,!0);var c=new Db;this.u.Ib(this.path,a,null,Eb(c,b));return c.sa};
h.update=function(a,b){A("Firebase.update",1,2,arguments.length);Nf("Firebase.update",this.path);if(da(a)){for(var c={},d=0;d<a.length;++d)c[""+d]=a[d];a=c;O("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}If("Firebase.update",a,this.path);B("Firebase.update",2,b,!0);c=new Db;this.u.update(this.path,a,Eb(c,b));return c.sa};
h.Ib=function(a,b,c){A("Firebase.setWithPriority",2,3,arguments.length);Nf("Firebase.setWithPriority",this.path);Ff("Firebase.setWithPriority",a,this.path,!1);Jf("Firebase.setWithPriority",2,b);B("Firebase.setWithPriority",3,c,!0);if(".length"===this.getKey()||".keys"===this.getKey())throw"Firebase.setWithPriority failed: "+this.getKey()+" is a read-only object.";var d=new Db;this.u.Ib(this.path,a,b,Eb(d,c));return d.sa};
h.remove=function(a){A("Firebase.remove",0,1,arguments.length);Nf("Firebase.remove",this.path);B("Firebase.remove",1,a,!0);return this.set(null,a)};
h.transaction=function(a,b,c){A("Firebase.transaction",1,3,arguments.length);Nf("Firebase.transaction",this.path);B("Firebase.transaction",1,a,!1);B("Firebase.transaction",2,b,!0);if(p(c)&&"boolean"!=typeof c)throw Error(zb("Firebase.transaction",3,!0)+"must be a boolean.");if(".length"===this.getKey()||".keys"===this.getKey())throw"Firebase.transaction failed: "+this.getKey()+" is a read-only object.";"undefined"===typeof c&&(c=!0);var d=new Db;t(b)&&Fb(d.sa);fi(this.u,this.path,a,function(a,c,g){a?
d.reject(a):d.resolve(new Lb(c,g));t(b)&&b(a,c,g)},c);return d.sa};h.vg=function(a,b){A("Firebase.setPriority",1,2,arguments.length);Nf("Firebase.setPriority",this.path);Jf("Firebase.setPriority",1,a);B("Firebase.setPriority",2,b,!0);var c=new Db;this.u.Ib(this.path.k(".priority"),a,null,Eb(c,b));return c.sa};
h.push=function(a,b){A("Firebase.push",0,2,arguments.length);Nf("Firebase.push",this.path);Ff("Firebase.push",a,this.path,!0);B("Firebase.push",2,b,!0);var c=$h(this.u),d=Vf(c),c=this.k(d);if(null!=a){var e=this,f=c.set(a,b).then(function(){return e.k(d)});c.then=u(f.then,f);c["catch"]=u(f.then,f,void 0);t(b)&&Fb(f)}return c};h.ib=function(){Nf("Firebase.onDisconnect",this.path);return new V(this.u,this.path)};U.prototype.child=U.prototype.k;U.prototype.set=U.prototype.set;U.prototype.update=U.prototype.update;
U.prototype.setWithPriority=U.prototype.Ib;U.prototype.remove=U.prototype.remove;U.prototype.transaction=U.prototype.transaction;U.prototype.setPriority=U.prototype.vg;U.prototype.push=U.prototype.push;U.prototype.onDisconnect=U.prototype.ib;hd(U.prototype,"database",U.prototype.Pf);hd(U.prototype,"key",U.prototype.getKey);hd(U.prototype,"parent",U.prototype.getParent);hd(U.prototype,"root",U.prototype.Zf);if("undefined"===typeof firebase)throw Error("Cannot install Firebase Database - be sure to load firebase-app.js first.");
try{var oi=firebase.INTERNAL.registerService("database",function(a){var b=zf.Ub(),c=a.options.databaseURL;p(c)||Xc("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.intializeApp().");var d=Yc(c),c=d.hc;yf("Invalid Firebase Database URL",d);d.path.e()||Xc("Database URL must point to the root of a Firebase Database (not including a child path).");(d=z(b.lb,a.name))&&Xc("FIREBASE INTERNAL ERROR: Database initialized multiple times.");d=new uf(c,b.Ef,
a);b.lb[a.name]=d;return d.Za},{Reference:U,Query:X,Database:tf,enableLogging:Uc,INTERNAL:Y,TEST_ACCESS:Z,ServerValue:wf});module.exports=oi}catch(pi){Xc("Failed to register the Firebase Database Service ("+pi+")")};
})();

